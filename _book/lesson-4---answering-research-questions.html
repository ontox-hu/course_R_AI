<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lesson 4 - Answering research questions | Intro into R, Reproducible research and machine learning</title>
  <meta name="description" content="Lesson 4 - Answering research questions | Intro into R, Reproducible research and machine learning" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Lesson 4 - Answering research questions | Intro into R, Reproducible research and machine learning" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lesson 4 - Answering research questions | Intro into R, Reproducible research and machine learning" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lesson-3---importing-data-tidy-data.html"/>
<link rel="next" href="lesson-5---answering-research-questions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />










<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img style="float:left;" src="images/voorbeeldlogo2.png"></a> <h4 class=".paddingtitel ">DAUR1 </h2></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-outline"><i class="fa fa-check"></i>Course outline</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-material"><i class="fa fa-check"></i>Course material</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#lessons"><i class="fa fa-check"></i>Lessons</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#rstudio-server"><i class="fa fa-check"></i>Rstudio server</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i>Learning objectives</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html"><i class="fa fa-check"></i>Preparation before the course</a>
<ul>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#lets-get-started"><i class="fa fa-check"></i>Let’s get started!</a>
<ul>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#remarks-before-starting"><i class="fa fa-check"></i>Remarks before starting</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#updating-r-and-rstudio"><i class="fa fa-check"></i>Updating R and RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#windows-users-1"><i class="fa fa-check"></i>Windows users</a></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#mac-users-1"><i class="fa fa-check"></i>Mac users</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#installRhere"><i class="fa fa-check"></i>Install R</a>
<ul>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#windows"><i class="fa fa-check"></i>Windows</a></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#mac"><i class="fa fa-check"></i>Mac</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#install-rstudio"><i class="fa fa-check"></i>Install RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#install-rstudio-itself"><i class="fa fa-check"></i>Install RStudio itself</a></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#installing-packages"><i class="fa fa-check"></i>Installing packages</a></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#loading-packages"><i class="fa fa-check"></i>Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#if-all-is-still-not-well"><i class="fa fa-check"></i>If all is still not well</a></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#reader"><i class="fa fa-check"></i>reader</a></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#introduction-to-r"><i class="fa fa-check"></i>Introduction to R</a>
<ul>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#variables-and-functions"><i class="fa fa-check"></i>Variables and functions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#rstudio"><i class="fa fa-check"></i>Rstudio</a>
<ul>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#console"><i class="fa fa-check"></i>Console</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#projects"><i class="fa fa-check"></i>Projects</a>
<ul>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#starting-a-new-project-in-rstudio"><i class="fa fa-check"></i>Starting a new Project in Rstudio</a></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#opening-a-project-in-rstudio"><i class="fa fa-check"></i>Opening a project in Rstudio</a></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#more-help"><i class="fa fa-check"></i>More help</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preparation-before-the-course.html"><a href="preparation-before-the-course.html#diy"><i class="fa fa-check"></i>DIY</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i>Lesson 1 - Introduction to R and RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#contents-day-1"><i class="fa fa-check"></i>Contents day 1</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#starting-to-work-within-a-project"><i class="fa fa-check"></i>Starting to work within a project</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#running-code-in-rstudio"><i class="fa fa-check"></i>Running code in Rstudio</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#variables"><i class="fa fa-check"></i>Variables</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#packages-and-libraries"><i class="fa fa-check"></i>Packages and libraries</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#the-help-function"><i class="fa fa-check"></i>The help function</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#data-types-and-structures-in-r"><i class="fa fa-check"></i>Data types and structures in R</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#indexing"><i class="fa fa-check"></i>Indexing</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#missing-values"><i class="fa fa-check"></i>Missing values</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#secondstart"><i class="fa fa-check"></i>More complicated data</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#lists"><i class="fa fa-check"></i>Lists</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#selecting-list-elements"><i class="fa fa-check"></i>Selecting list elements</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#headers"><i class="fa fa-check"></i>Headers</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#dataframes"><i class="fa fa-check"></i>Dataframes</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#data-analysis-using-dataframes"><i class="fa fa-check"></i>Data analysis using dataframes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#tibbles"><i class="fa fa-check"></i>Tibbles</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#factors"><i class="fa fa-check"></i>Factors</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#using-functions-drc"><i class="fa fa-check"></i>using functions: drc</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#scripts-and-rmarkdown"><i class="fa fa-check"></i>scripts and Rmarkdown</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#scripts"><i class="fa fa-check"></i>scripts</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#rmarkdown"><i class="fa fa-check"></i>Rmarkdown</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#yaml-header"><i class="fa fa-check"></i>YAML header</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#code-chunks"><i class="fa fa-check"></i>Code chunks</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#output-control"><i class="fa fa-check"></i>Output control</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#plain-text-formatting"><i class="fa fa-check"></i>Plain text formatting</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#here-package"><i class="fa fa-check"></i>Here package</a></li>
<li class="chapter" data-level="" data-path="lesson-1---introduction-to-r-and-rstudio.html"><a href="lesson-1---introduction-to-r-and-rstudio.html#creating-a-new-rmarkdown-file"><i class="fa fa-check"></i>Creating a new RMarkdown file</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lesson-2---data-types-and-structures-in-r.html"><a href="lesson-2---data-types-and-structures-in-r.html"><i class="fa fa-check"></i>Lesson 2 - Data types and structures in R</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-2---data-types-and-structures-in-r.html"><a href="lesson-2---data-types-and-structures-in-r.html#contents-day-2"><i class="fa fa-check"></i>Contents day 2</a></li>
<li class="chapter" data-level="" data-path="lesson-2---data-types-and-structures-in-r.html"><a href="lesson-2---data-types-and-structures-in-r.html#learning-objectives-1"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="lesson-2---data-types-and-structures-in-r.html"><a href="lesson-2---data-types-and-structures-in-r.html#importing-text-files"><i class="fa fa-check"></i>Importing text files</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-2---data-types-and-structures-in-r.html"><a href="lesson-2---data-types-and-structures-in-r.html#separators"><i class="fa fa-check"></i>separators</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html"><i class="fa fa-check"></i>Lesson 3 - Importing data &amp; tidy data</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#contents-day-3"><i class="fa fa-check"></i>Contents day 3</a></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#learning-objectives-2"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#importing-text-files-1"><i class="fa fa-check"></i>Importing text files</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#separators-1"><i class="fa fa-check"></i>separators</a></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#extracting-numbers"><i class="fa fa-check"></i>extracting numbers</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#setting-variable-column-names"><i class="fa fa-check"></i>Setting variable (column) names</a></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#importing-excel-files"><i class="fa fa-check"></i>Importing Excel files</a></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#saving-and-importing-r_objects"><i class="fa fa-check"></i>Saving and importing R_Objects</a></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#inspecting-your-data"><i class="fa fa-check"></i>Inspecting your data</a></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#what-is-tidy-data"><i class="fa fa-check"></i>What is tidy data?</a></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#making-your-data-tidy-gathering"><i class="fa fa-check"></i>Making your data tidy: gathering</a></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#making_your_data_tidy-spreading"><i class="fa fa-check"></i>Making_your_data_tidy: spreading</a></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#making_your_data_tidy-separate"><i class="fa fa-check"></i>Making_your_data_tidy: separate</a></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#checking-normality"><i class="fa fa-check"></i>Checking normality</a></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#map-functions"><i class="fa fa-check"></i>map functions</a></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#histograms"><i class="fa fa-check"></i>Histograms</a></li>
<li class="chapter" data-level="" data-path="lesson-3---importing-data-tidy-data.html"><a href="lesson-3---importing-data-tidy-data.html#overview-r-functions"><i class="fa fa-check"></i>Overview R functions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html"><i class="fa fa-check"></i>Lesson 4 - Answering research questions</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#learning-objectives-3"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#difference-questions"><i class="fa fa-check"></i>Difference Questions</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#practice-making-bar-charts"><i class="fa fa-check"></i>Practice making bar charts</a></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#two-sample-t-tests"><i class="fa fa-check"></i>Two sample t-tests</a></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#unpaired-two-sample-t-test"><i class="fa fa-check"></i>Unpaired two sample t test</a></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#paired-two-sample-t-test"><i class="fa fa-check"></i>Paired two sample t test</a></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#plotting-significance"><i class="fa fa-check"></i>Plotting significance</a></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#anova"><i class="fa fa-check"></i>ANOVA</a></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#one-sample-t-test"><i class="fa fa-check"></i>One sample t-test</a></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#detection"><i class="fa fa-check"></i>Detection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#descriptive-questions"><i class="fa fa-check"></i>Descriptive Questions</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#line-graphs"><i class="fa fa-check"></i>Line graphs</a></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#boxplots"><i class="fa fa-check"></i>Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#outliers"><i class="fa fa-check"></i>Outliers</a></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#relation-questions"><i class="fa fa-check"></i>Relation Questions</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#correlation"><i class="fa fa-check"></i>Correlation</a></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#regression"><i class="fa fa-check"></i>Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#checklists"><i class="fa fa-check"></i>Checklists</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#verschilvragen"><i class="fa fa-check"></i>verschilvragen</a></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#verbandvragen"><i class="fa fa-check"></i>verbandvragen</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lesson-4---answering-research-questions.html"><a href="lesson-4---answering-research-questions.html#overview-r-functions-1"><i class="fa fa-check"></i>Overview R functions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lesson-5---answering-research-questions.html"><a href="lesson-5---answering-research-questions.html"><i class="fa fa-check"></i>Lesson 5 - Answering research questions</a>
<ul>
<li class="chapter" data-level="" data-path="lesson-5---answering-research-questions.html"><a href="lesson-5---answering-research-questions.html#learning-objectives-4"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="lesson-5---answering-research-questions.html"><a href="lesson-5---answering-research-questions.html#packages"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="lesson-5---answering-research-questions.html"><a href="lesson-5---answering-research-questions.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="lesson-5---answering-research-questions.html"><a href="lesson-5---answering-research-questions.html#comptox"><i class="fa fa-check"></i>Comptox</a></li>
<li class="chapter" data-level="" data-path="lesson-5---answering-research-questions.html"><a href="lesson-5---answering-research-questions.html#qsar-data"><i class="fa fa-check"></i>QSAR data</a></li>
<li class="chapter" data-level="" data-path="lesson-5---answering-research-questions.html"><a href="lesson-5---answering-research-questions.html#exercise"><i class="fa fa-check"></i>EXERCISE</a></li>
<li class="chapter" data-level="" data-path="lesson-5---answering-research-questions.html"><a href="lesson-5---answering-research-questions.html#unsupervised-machine-learning"><i class="fa fa-check"></i>Unsupervised machine learning</a></li>
<li class="chapter" data-level="" data-path="lesson-5---answering-research-questions.html"><a href="lesson-5---answering-research-questions.html#principal-component-analysis"><i class="fa fa-check"></i>Principal Component Analysis</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro into R, Reproducible research and machine learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lesson-4---answering-research-questions" class="section level1">
<h1>Lesson 4 - Answering research questions</h1>
<p><img src="images/04_1_ggplot.png" width="50%" style="display: block; margin: auto;" /></p>
<p>DAY 4:
Functional programming
Writing functions
DAY 5:
Machine Learning with {tidymodels}
Deep Learning with tensorflow for R</p>
<div id="learning-objectives-3" class="section level2">
<h2>Learning objectives</h2>
<p>After this lesson:</p>
<ul>
<li>You will have a basic understanding of different graph types and when to use them.</li>
<li>You can visualize categorical data with ggplot.</li>
<li>You can visualize continuous data with ggplot.</li>
<li>You can summarize data using boxplots.</li>
<li>you can perform the most common statistical tests with R.</li>
</ul>
<p>note: if your data is not in a folder /data/, just ignore that part of the path name!</p>
</div>
<div id="difference-questions" class="section level2">
<h2>Difference Questions</h2>
<p>When your research question is about a possible difference between samples (e.g. groups, conditions, etc) you often make a bar chart, and perform a t-test or ANOVA (if your data is normally distributed, see previous lesson).</p>
<div id="practice-making-bar-charts" class="section level3">
<h3>Practice making bar charts</h3>
<p>To start this lesson, we will first practice a bit with using ggplot2. We used it before to make histograms, but ggplot can make a lot of different graphs.</p>
<p>A <strong>bar chart</strong> is a graph that presents categorical (nominal) data with rectangular <strong>bars</strong> with heights or lengths proportional to the values that they represent. The bars can be plotted vertically or horizontally.</p>
<p>To create a bar chart we can either use:</p>
<ul>
<li><code>geom_bar()</code>: by default, geom_bar() accepts one variable (categorical) as x-value. The number of occurrences for each category is calculated by default.</li>
<li><code>geom_col()</code>: by default, geom_col() accepts one variable (categorical) as x-value and one variable (values of each category such as occurences, mean, median, proportion, min, max and so on) as y-value.</li>
</ul>
<p>Note: arguments in the ggplot() function will be applied to all layers whereas arguments in the geom_function() layer will only be applied to that specific layer.</p>
<div id="examples" class="section level6">
<h6>Examples</h6>
<p>Let’s plot the amount of penguins per species in the <code>palmerpenguins</code> dataset (install it if needed):</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="lesson-4---answering-research-questions.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the tidyverse package (only once for each R session)</span></span>
<span id="cb337-2"><a href="lesson-4---answering-research-questions.html#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.3.6     ✔ purrr   0.3.4
## ✔ tibble  3.1.7     ✔ dplyr   1.0.9
## ✔ tidyr   1.2.0     ✔ stringr 1.4.0
## ✔ readr   2.1.2     ✔ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="lesson-4---answering-research-questions.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins) <span class="co">#let&#39;s use some penguin data. Penguins are cool.</span></span>
<span id="cb341-2"><a href="lesson-4---answering-research-questions.html#cb341-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-3"><a href="lesson-4---answering-research-questions.html#cb341-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar graph showing the counts based on variable species</span></span>
<span id="cb341-4"><a href="lesson-4---answering-research-questions.html#cb341-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-5"><a href="lesson-4---answering-research-questions.html#cb341-5" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="co"># penguins is a datagframe within the palmerpenguins package</span></span>
<span id="cb341-6"><a href="lesson-4---answering-research-questions.html#cb341-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb341-7"><a href="lesson-4---answering-research-questions.html#cb341-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> species)) <span class="sc">+</span></span>
<span id="cb341-8"><a href="lesson-4---answering-research-questions.html#cb341-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb341-9"><a href="lesson-4---answering-research-questions.html#cb341-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Penguins per Species in the Palmerpenguins data&#39;</span>)</span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>If we want to change the color of the bars based on the variable ‘species’ (3 different colours, because there are 3 different species), we can add an extra aestheti(c) ‘fill’. If we want to generally change the color of the bars, we can add ‘fill’ outside of the aesthetic.</p>
</div>
<div id="examples-1" class="section level6">
<h6>Examples</h6>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="lesson-4---answering-research-questions.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;fill&quot; is placed inside aesthetic</span></span>
<span id="cb342-2"><a href="lesson-4---answering-research-questions.html#cb342-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span></span>
<span id="cb342-3"><a href="lesson-4---answering-research-questions.html#cb342-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb342-4"><a href="lesson-4---answering-research-questions.html#cb342-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb342-5"><a href="lesson-4---answering-research-questions.html#cb342-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb342-6"><a href="lesson-4---answering-research-questions.html#cb342-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Penguins per Species in the Palmerpenguins data&#39;</span>)</span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="lesson-4---answering-research-questions.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;fill&quot; is placed outside the aesthetic</span></span>
<span id="cb343-2"><a href="lesson-4---answering-research-questions.html#cb343-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span></span>
<span id="cb343-3"><a href="lesson-4---answering-research-questions.html#cb343-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb343-4"><a href="lesson-4---answering-research-questions.html#cb343-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> species), <span class="at">fill =</span> <span class="st">&quot;magenta&quot;</span>) <span class="sc">+</span></span>
<span id="cb343-5"><a href="lesson-4---answering-research-questions.html#cb343-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb343-6"><a href="lesson-4---answering-research-questions.html#cb343-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Penguins per Species in the Palmerpenguins data&#39;</span>)</span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="lesson-4---answering-research-questions.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;color&quot; defines border color</span></span>
<span id="cb344-2"><a href="lesson-4---answering-research-questions.html#cb344-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span></span>
<span id="cb344-3"><a href="lesson-4---answering-research-questions.html#cb344-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb344-4"><a href="lesson-4---answering-research-questions.html#cb344-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> species), <span class="at">fill =</span> <span class="st">&quot;magenta&quot;</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb344-5"><a href="lesson-4---answering-research-questions.html#cb344-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb344-6"><a href="lesson-4---answering-research-questions.html#cb344-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Penguins per Species in the Palmerpenguins data&#39;</span>)</span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-5-3.png" width="672" /></p>
<p>Each geom_funtion has a standard way of calculating and presenting the data. This is defined by the ‘stat’ argument. The default for <code>geom_bar()</code> is ‘count’, meaning <code>geom_bar()</code> displays the number of occurences of each category in variable “class” on the y-axis.</p>
<p>Alternatively, the <code>geom_bar()</code> can also calculate and display the proportion of each category (relative to the total number) on the y-axis. To do so we must explicitly instruct <code>geom_bar()</code> to change the default stat of count to proportion (..prop..). An alternative way to create a graph showing the proportion of each category is to first calculate the proportion values by using some handy functions of the tidyverse packages (see also lesson 5). The new values are then stored in a separate variable.</p>
</div>
<div id="examples-2" class="section level6">
<h6>Examples</h6>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="lesson-4---answering-research-questions.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar graph plotting the proportions (using ..prop..)</span></span>
<span id="cb345-2"><a href="lesson-4---answering-research-questions.html#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="co"># NB: &#39;group = 1&#39; indicates that the proportions are based on entire population</span></span>
<span id="cb345-3"><a href="lesson-4---answering-research-questions.html#cb345-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span> </span>
<span id="cb345-4"><a href="lesson-4---answering-research-questions.html#cb345-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span>..prop.., <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb345-5"><a href="lesson-4---answering-research-questions.html#cb345-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;proportions of Penguins per Species&#39;</span>)</span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="lesson-4---answering-research-questions.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the counts of each category of the class variable using count() and</span></span>
<span id="cb346-2"><a href="lesson-4---answering-research-questions.html#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="co"># add a new variable that is a function of existing columns using mutate(). Use</span></span>
<span id="cb346-3"><a href="lesson-4---answering-research-questions.html#cb346-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the new variable to create a bar graph.</span></span>
<span id="cb346-4"><a href="lesson-4---answering-research-questions.html#cb346-4" aria-hidden="true" tabindex="-1"></a><span class="co"># NB: count() creates a new variable &#39;n&#39; containing the counts</span></span>
<span id="cb346-5"><a href="lesson-4---answering-research-questions.html#cb346-5" aria-hidden="true" tabindex="-1"></a>penguins  <span class="sc">%&gt;%</span>  <span class="fu">count</span>(species) <span class="sc">%&gt;%</span>  </span>
<span id="cb346-6"><a href="lesson-4---answering-research-questions.html#cb346-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb346-7"><a href="lesson-4---answering-research-questions.html#cb346-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb346-8"><a href="lesson-4---answering-research-questions.html#cb346-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> proportion, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb346-9"><a href="lesson-4---answering-research-questions.html#cb346-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Also proportions of Penguins per Species&#39;</span>)</span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<!-- By first calculating the proportion values manually, we can display the counts of each category in ascending or decending order. In combination with the `reorder()` function we change the order of the x-axis value based on the counts. To show the bars in descending order, we can simply put a minus sign before the variable in the `reorder()` function (see examples below). -->
<!-- ```{r} -->
<!-- # Create a bar graph after calculating the counts using count() -->
<!-- # NB: the x-axis categories are reordered based on the counts. -->
<!-- penguins %>% count(species) %>%   -->
<!--   ggplot() +  -->
<!--   geom_col(aes(x = reorder(species, n), y = n,  fill = species)) -->
<!-- # Fix the axis titles by setting them manually in labs: -->
<!-- penguins %>% count(species) %>%   -->
<!--   ggplot() +  -->
<!--   geom_col(aes(x = reorder(species, n), y = n,  fill = species))+ -->
<!--     labs(title = "penguin count per species", -->
<!--        subtitle = "in ascending order", -->
<!--        x = "species", -->
<!--        y = "count")  -->
<!-- # Similar to previous example, but with bars in descending order -->
<!-- # and bar-labels on the bars -->
<!-- penguins %>% count(species) %>%   -->
<!--   ggplot() +  -->
<!--   geom_col(aes(x = reorder(species, -n), y = n, fill = species))+ -->
<!--       labs(title = "penguin count per species", -->
<!--        subtitle = "in descending order", -->
<!--        x = "species", -->
<!--        y = "count") + -->
<!--   geom_label(aes(x = species, y = n, label = n)) #add labels -->
<!-- ``` -->
</div>
<div id="exercise-4" class="section level5 unnumbered question">
<h5>Exercise 4</h5>
<p>Stars are classified by their spectra (the wavelengths that they absorb) and their temperature. There are seven main types of stars based on decreasing temperature. The categories are: O, B, A, F, G, K, and M. Use the dataset ‘stars’ from the ‘dslabs’ package to answer the following questions:</p>
<ol style="list-style-type: lower-alpha">
<li>Make a graph to show the number of stars for each type.</li>
<li>Make a graph to show the number of stars for each type. Each bar has a different color.</li>
<li>Add a black line to the different coloured bars of graph (b).</li>
</ol>
</div>
<details>
<summary>
Click if you want to see what the graphs should look like
</summary>
<ol style="list-style-type: lower-alpha">
<li><img src="les4_files/figure-html/unnamed-chunk-7-1.png" width="672" /></li>
<li><img src="les4_files/figure-html/unnamed-chunk-8-1.png" width="672" /></li>
<li><img src="les4_files/figure-html/unnamed-chunk-9-1.png" width="672" /></li>
</ol>
</details>
<details>
<summary>
Click if you really tried and can’t replicate the graphs from the answer above
</summary>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="lesson-4---answering-research-questions.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb347-2"><a href="lesson-4---answering-research-questions.html#cb347-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stars, <span class="fu">aes</span>(<span class="at">x =</span> type)) <span class="sc">+</span> </span>
<span id="cb347-3"><a href="lesson-4---answering-research-questions.html#cb347-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb347-4"><a href="lesson-4---answering-research-questions.html#cb347-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of stars for each type&quot;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="lesson-4---answering-research-questions.html#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stars, <span class="fu">aes</span>(<span class="at">x =</span> type)) <span class="sc">+</span> </span>
<span id="cb348-2"><a href="lesson-4---answering-research-questions.html#cb348-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> type))<span class="sc">+</span></span>
<span id="cb348-3"><a href="lesson-4---answering-research-questions.html#cb348-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of stars for each type&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="lesson-4---answering-research-questions.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stars, <span class="fu">aes</span>(<span class="at">x =</span> type)) <span class="sc">+</span> </span>
<span id="cb349-2"><a href="lesson-4---answering-research-questions.html#cb349-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> type), <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb349-3"><a href="lesson-4---answering-research-questions.html#cb349-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of stars for each type&quot;</span>)</span></code></pre></div>
</details>
<!-- <div class="question"> -->
<!-- ##### Exercise 4 {-}  -->
<!-- Make a graph to show the number of stars for each type in descending order. Each bar has a different color and a black line. -->
<!-- Hint: first calculate the numbers for each category of the variable 'type'. To make the graph use `geom_col()` instead of `geom_bar()`. -->
<!-- </div> -->
<!-- <details><summary>Click for the answer</summary> -->
<!-- 1.2: -->
<!-- ```{r, echo=F} -->
<!-- stars %>% count(type) %>% -->
<!--   ggplot(aes(x = reorder(type , -n), y = n)) + -->
<!--     geom_col(aes(fill = type), colour = "black")+ -->
<!--     labs(title = "Number of stars for each type") -->
<!-- ``` -->
<!-- </details> -->
<!-- <details><summary>Click if you really tried and can't replicate the graph from the answer above</summary> -->
<!-- 1.2: -->
<!-- ```{r, eval=F} -->
<!-- stars %>% count(type) %>% -->
<!--   ggplot(aes(x = reorder(type , -n), y = n)) + -->
<!--     geom_col(aes(fill = type), colour = "black")+ -->
<!--     labs(title = "Number of stars for each type") -->
<!-- ``` -->
<!-- </details> -->
<div id="grouped-bar-graphs" class="section level4">
<h4>Grouped bar graphs</h4>
<p>In the examples above, the bar graphs consisted of single bars. In some cases you want to create <strong>grouped bar graphs</strong>. For example, given the penguin dataset introduced above, suppose that you want to know how many male and female penguins there are for each species. You can create a bar graph in a similar way as before, but now specifying ‘fill’ to be determined by ‘sex’:</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="lesson-4---answering-research-questions.html#cb350-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">count</span>(species, sex) <span class="sc">%&gt;%</span>  </span>
<span id="cb350-2"><a href="lesson-4---answering-research-questions.html#cb350-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> n, <span class="at">fill =</span> sex)) <span class="sc">+</span> </span>
<span id="cb350-3"><a href="lesson-4---answering-research-questions.html#cb350-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>We now created a grouped bar graph. However, the default of ggplot is to plot the different bars on top of each other and this is difficult to read. To plot the different bars next to each other, we can use the <code>position_dodge()</code> argument:</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="lesson-4---answering-research-questions.html#cb351-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> <span class="fu">count</span>(species, sex) <span class="sc">%&gt;%</span>  </span>
<span id="cb351-2"><a href="lesson-4---answering-research-questions.html#cb351-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> n, <span class="at">fill =</span> sex)) <span class="sc">+</span> </span>
<span id="cb351-3"><a href="lesson-4---answering-research-questions.html#cb351-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>())</span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="bar-graphs-with-mean-standard-deviation" class="section level4">
<h4>Bar graphs with mean ± standard deviation</h4>
<p>Quite often, you will want to depict an average and standard deviation in a bar graph. For instance, the average flipper length in the different penguin species.</p>
<p>To make a bar graph with the average flipper length, we will need to calculate it first. We will do a lot more data wrangling in the next lesson, so for now, we will just make a new tibble with the averages we need, grouped per species. There are some missing values for flipper length (I imagine not all penguins cooperated nicely when their feet were measured), and we remove those using <code>na.rm=TRUE</code>. Look at the content of <code>flipper_summary</code> by typing it in the console.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="lesson-4---answering-research-questions.html#cb352-1" aria-hidden="true" tabindex="-1"></a>flipper_summary <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span></span>
<span id="cb352-2"><a href="lesson-4---answering-research-questions.html#cb352-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb352-3"><a href="lesson-4---answering-research-questions.html#cb352-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_flipper=</span><span class="fu">mean</span>(flipper_length_mm, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">stdev=</span><span class="fu">sd</span>(flipper_length_mm, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code></pre></div>
<p>And we can plot this using:</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="lesson-4---answering-research-questions.html#cb353-1" aria-hidden="true" tabindex="-1"></a>flipper_summary <span class="sc">%&gt;%</span></span>
<span id="cb353-2"><a href="lesson-4---answering-research-questions.html#cb353-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>species,<span class="at">y=</span>mean_flipper, <span class="at">group=</span>species, <span class="at">fill=</span>species)) <span class="sc">+</span> </span>
<span id="cb353-3"><a href="lesson-4---answering-research-questions.html#cb353-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span> </span>
<span id="cb353-4"><a href="lesson-4---answering-research-questions.html#cb353-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>mean_flipper<span class="sc">-</span>stdev, <span class="at">ymax=</span>mean_flipper<span class="sc">+</span>stdev), <span class="at">width=</span>.<span class="dv">2</span>)<span class="sc">+</span> <span class="co"># the error bars</span></span>
<span id="cb353-5"><a href="lesson-4---answering-research-questions.html#cb353-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Figure X. average flipper length of penguins&quot;</span>, </span>
<span id="cb353-6"><a href="lesson-4---answering-research-questions.html#cb353-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;errorbars depict 1 standard deviation&quot;</span>,</span>
<span id="cb353-7"><a href="lesson-4---answering-research-questions.html#cb353-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;penguin species&quot;</span>, </span>
<span id="cb353-8"><a href="lesson-4---answering-research-questions.html#cb353-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;average flipper length (mm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb353-9"><a href="lesson-4---answering-research-questions.html#cb353-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)) <span class="co"># legend is not needed</span></span></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: stat</code></pre>
<p><img src="les4_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>
<div id="two-sample-t-tests" class="section level3">
<h3>Two sample t-tests</h3>
<p>Often, bar graphs are used to visualise possible <strong>differences</strong> between samples (e.g. between groups, conditions, etc). Generally, we then have a <strong>categorical variable on the x-axis</strong> (such as penguin species), and a <strong>continuous variable on the y-axis</strong> (such as flipper length in mm.).</p>
<p>But obviously you will have to do some statistics before we can confidently proclaim we see any differences between the conditions.</p>
<p>Before running a t-test in R we need to know:</p>
<ol style="list-style-type: decimal">
<li>The experimental set-up (i.e. unpaired vs paired)</li>
</ol>
<div class="figure"><span style="display:block;" id="fig:pairedfig"></span>
<img src="images/08_5_paired_unpaired.jpg" alt="Unpaired or paired experimental set-up examples" width="80%" />
<p class="caption">
Figure 7: Unpaired or paired experimental set-up examples
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>whether the samples have equal variances (NOTE: only relevant with an unpaired experimental set up)</li>
</ol>
<hr />
</div>
<div id="unpaired-two-sample-t-test" class="section level3">
<h3>Unpaired two sample t test</h3>
<p>As unpaired experiments are a bit more intuitive, we will start with an unpaired two sample t-test.</p>
<div id="get-the-data-and-prepare-the-data" class="section level4">
<h4>1. Get the data and prepare the data</h4>
<p>Here is some artificial data on ear length of rabbits:</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="lesson-4---answering-research-questions.html#cb355-1" aria-hidden="true" tabindex="-1"></a>rabbit_ears <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb355-2"><a href="lesson-4---answering-research-questions.html#cb355-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">rabbitnr =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>),</span>
<span id="cb355-3"><a href="lesson-4---answering-research-questions.html#cb355-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">colour =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;beige&quot;</span>, <span class="dv">10</span>),<span class="fu">rep</span>(<span class="st">&quot;brown&quot;</span>, <span class="dv">10</span>)),</span>
<span id="cb355-4"><a href="lesson-4---answering-research-questions.html#cb355-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">earlength =</span> <span class="fu">c</span>(<span class="fl">17.5</span>, <span class="fl">13.0</span>, <span class="fl">18.6</span>, <span class="fl">19.4</span>, <span class="fl">20.9</span>, <span class="fl">18.9</span>, <span class="fl">22.8</span>, <span class="fl">20.3</span>, <span class="fl">22.1</span>, <span class="fl">20.4</span>, <span class="fl">23.0</span>,</span>
<span id="cb355-5"><a href="lesson-4---answering-research-questions.html#cb355-5" aria-hidden="true" tabindex="-1"></a><span class="fl">24.1</span>, <span class="fl">26.1</span>, <span class="fl">25.2</span>, <span class="fl">27.8</span>, <span class="fl">28.5</span>, <span class="fl">26.5</span>, <span class="fl">21.5</span>, <span class="fl">20.2</span>, <span class="fl">18.8</span>)</span>
<span id="cb355-6"><a href="lesson-4---answering-research-questions.html#cb355-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb355-7"><a href="lesson-4---answering-research-questions.html#cb355-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-8"><a href="lesson-4---answering-research-questions.html#cb355-8" aria-hidden="true" tabindex="-1"></a>colour_rabbits_summary <span class="ot">&lt;-</span> rabbit_ears <span class="sc">%&gt;%</span></span>
<span id="cb355-9"><a href="lesson-4---answering-research-questions.html#cb355-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(colour) <span class="sc">%&gt;%</span></span>
<span id="cb355-10"><a href="lesson-4---answering-research-questions.html#cb355-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_ear=</span><span class="fu">mean</span>(earlength), <span class="at">stdev=</span><span class="fu">sd</span>(earlength))</span></code></pre></div>
</div>
<div id="plot-the-data" class="section level4">
<h4>2. Plot the data</h4>
<pre><code>## Warning: Ignoring unknown parameters: stat</code></pre>
<p><img src="les4_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Looking at the bar graph, the ear length brown rabbits seems to be a bit longer, on average, than in beige rabbits. Let’s investigate this.</p>
</div>
<div id="check-normality" class="section level4">
<h4>3. Check normality</h4>
<ul>
<li>Research question: Is there a difference in ear length between brown and beige rabbits?</li>
</ul>
<div id="exercise-7-1" class="section level5 question">
<h5>Exercise 7</h5>
<p>As you have learned in lesson 3, we first need to check whether the data is normally distributed. Please check.</p>
</div>
<details>
<summary>
HINT
</summary>
<p>You need to use <code>shapiro.test</code>.</p>
<p>We have two groups of rabbits, so <strong>both</strong> groups need to have normally distributed ear lengths. The ear length is currently in a tidy format, bu we previously mapped shapiro.test() to data in wide format…</p>
<p>You have several options, all of which are fine.</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>manually split the data using indexing (lesson 1) (specifically, look at the homework assignment after lesson 2). Realise that the colour variable is text data, not a number.</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>use <code>pivot_wider</code> to make separate columns for ear length in the two groups (lesson 3) and then index the column you want (lesson 1)</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>magically already know how to summarise (lesson 5)</li>
</ol></li>
</ul>
</details>
<details>
<summary>
Click for the answer
</summary>
<p>Let’s do option 1 for now.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="lesson-4---answering-research-questions.html#cb357-1" aria-hidden="true" tabindex="-1"></a>brown_ears <span class="ot">&lt;-</span> rabbit_ears[rabbit_ears<span class="sc">$</span>colour<span class="sc">==</span><span class="st">&quot;brown&quot;</span>,]</span>
<span id="cb357-2"><a href="lesson-4---answering-research-questions.html#cb357-2" aria-hidden="true" tabindex="-1"></a>beige_ears <span class="ot">&lt;-</span> rabbit_ears[rabbit_ears<span class="sc">$</span>colour<span class="sc">==</span><span class="st">&quot;beige&quot;</span>,]</span>
<span id="cb357-3"><a href="lesson-4---answering-research-questions.html#cb357-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-4"><a href="lesson-4---answering-research-questions.html#cb357-4" aria-hidden="true" tabindex="-1"></a>brown_ears<span class="sc">$</span>earlength <span class="sc">%&gt;%</span> <span class="fu">shapiro.test</span>()</span>
<span id="cb357-5"><a href="lesson-4---answering-research-questions.html#cb357-5" aria-hidden="true" tabindex="-1"></a>beige_ears<span class="sc">$</span>earlength <span class="sc">%&gt;%</span> <span class="fu">shapiro.test</span>()</span></code></pre></div>
<p>The shorter option 3 you have not learned yet</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="lesson-4---answering-research-questions.html#cb358-1" aria-hidden="true" tabindex="-1"></a>rabbit_ears <span class="sc">%&gt;%</span></span>
<span id="cb358-2"><a href="lesson-4---answering-research-questions.html#cb358-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(colour) <span class="sc">%&gt;%</span></span>
<span id="cb358-3"><a href="lesson-4---answering-research-questions.html#cb358-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">p.value.sw =</span> <span class="fu">shapiro.test</span>(earlength)<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   colour p.value.sw
##   &lt;chr&gt;       &lt;dbl&gt;
## 1 beige       0.225
## 2 brown       0.785</code></pre>
Both have a p-value &gt; 0,05 meaning we can perform a normal parametric t-test.
</details>
</div>
<div id="check-the-variances" class="section level4">
<h4>4. Check the variances</h4>
<p>Next, as we have an unpaired design, we need to know if the variance in ear length in the two groups of rabbits is very different.</p>
<p>To test for equal variances we will make use of <strong>levene’s test</strong>. In the case of Levene’s test the null-hypothesis (H0) is defined as:</p>
<p><strong>H0: var1 = var2</strong> (samples come from populations with variances that are <strong>not different</strong>.)</p>
<p><strong>H1: var1 ≠ var2</strong> (samples come from populations with variances that are <strong>different</strong> from each other.)</p>
<div class="tip">
<p>Levene’s test can be used to check for equal <strong>variances</strong>.</p>
</div>
<p>To perform levene’s test use the function <code>leveneTest()</code> from the “car” package (“car” stands for “Companion to Applied Regression”, this package is not about cars.)</p>
<div id="example-47" class="section level6">
<h6>Example</h6>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="lesson-4---answering-research-questions.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the package and check out the function</span></span>
<span id="cb360-2"><a href="lesson-4---answering-research-questions.html#cb360-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb360-3"><a href="lesson-4---answering-research-questions.html#cb360-3" aria-hidden="true" tabindex="-1"></a>?<span class="fu">leveneTest</span>()   <span class="co"># check the arguments for running this function</span></span></code></pre></div>
<p>You can see that the input for <code>levenetest()</code> requires 1 vector with the data and another vector describing the groups. Our rabbit data is already in the correct format, but we have to convert the group variable (rabbit colour) to a <strong>factor</strong> to make sure R understands this is a categorical variable.</p>
<div class="tip">
<p>Tip: If R is absolutely refusing to cooperate, make sure you defined your variables correctly as categorical (factor), numbers or text.</p>
</div>
</div>
<div id="example-48" class="section level6">
<h6>Example</h6>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="lesson-4---answering-research-questions.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb361-2"><a href="lesson-4---answering-research-questions.html#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(rabbit_ears<span class="sc">$</span>earlength, <span class="fu">as.factor</span>(rabbit_ears<span class="sc">$</span>colour), <span class="at">center =</span> mean)</span></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = mean)
##       Df F value Pr(&gt;F)
## group  1  0.8626 0.3653
##       18</code></pre>
<p>We find a p-value (<strong>Pr(&gt;F)</strong>) of 0.365, which is &gt;0.05, so H0 is accepted. The groups have equal variance.</p>
</div>
</div>
<div id="perform-the-t-test" class="section level4">
<h4>5. Perform the t-test</h4>
<p>Finally we can perform a unpaired t-test with samples having equal variance. The <code>t.test()</code> function takes the following arguments:</p>
<ul>
<li>x : a (non-empty) numeric vector of data values.</li>
<li>y : an optional (non-empty) numeric vector of data values.</li>
<li>paired : a logical indicating whether you want a paired t-test.(determine by looking at the experimental design)</li>
<li>var.equal : a logical variable indicating whether to treat the two variances as being equal (determine with a Levene’s test)</li>
<li>conf.level : default 95%</li>
<li>formula : optional formula defining the data and the groups written as data ~ groups (when your data is in tidy format)</li>
</ul>
<p>Before we perform the t.test we have again to define the H0 and H1:</p>
<p><strong>H0: μ1 = μ2</strong> (brown and beige rabbits <strong>do not differ</strong> in mean ear length)</p>
<p><strong>H1: μ1 ≠ μ2</strong> (brown and beige rabbits <strong>do differ</strong> in mean ear length)</p>
<div id="example-49" class="section level6">
<h6>Example</h6>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="lesson-4---answering-research-questions.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">formula =</span> rabbit_ears<span class="sc">$</span>earlength <span class="sc">~</span> rabbit_ears<span class="sc">$</span>colour, </span>
<span id="cb363-2"><a href="lesson-4---answering-research-questions.html#cb363-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  rabbit_ears$earlength by rabbit_ears$colour
## t = -3.5452, df = 18, p-value = 0.002312
## alternative hypothesis: true difference in means between group beige and group brown is not equal to 0
## 95 percent confidence interval:
##  -7.612654 -1.947346
## sample estimates:
## mean in group beige mean in group brown 
##               19.39               24.17</code></pre>
<p>Or if you just want the p-value, rounded down to 3 digits:</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="lesson-4---answering-research-questions.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">formula =</span> rabbit_ears<span class="sc">$</span>earlength <span class="sc">~</span> rabbit_ears<span class="sc">$</span>colour, </span>
<span id="cb365-2"><a href="lesson-4---answering-research-questions.html#cb365-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value <span class="sc">%&gt;%</span> <span class="fu">round</span>(.,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.002</code></pre>
</div>
</div>
<div id="draw-a-conclusion" class="section level4">
<h4>5. Draw a conclusion</h4>
<p>Based on this p-value being below 0.05, we can conclude that there <strong>is a significant difference</strong> in ear length between brown rabbits (mean±sd = 24 ± 3 cm) and beige rabbits (19± 3 cm.), with brown rabbits having the on average longer ears.</p>
<hr />
<p>Note, the <code>t.test()</code> function has the option to enter the data separately. So, we don’t have to make the dataset tidy. It works on separate columns with data as well:</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="lesson-4---answering-research-questions.html#cb367-1" aria-hidden="true" tabindex="-1"></a>brown_ears <span class="ot">&lt;-</span> rabbit_ears[rabbit_ears<span class="sc">$</span>colour<span class="sc">==</span><span class="st">&quot;brown&quot;</span>,]</span>
<span id="cb367-2"><a href="lesson-4---answering-research-questions.html#cb367-2" aria-hidden="true" tabindex="-1"></a>beige_ears <span class="ot">&lt;-</span> rabbit_ears[rabbit_ears<span class="sc">$</span>colour<span class="sc">==</span><span class="st">&quot;beige&quot;</span>,]</span>
<span id="cb367-3"><a href="lesson-4---answering-research-questions.html#cb367-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-4"><a href="lesson-4---answering-research-questions.html#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="co"># note that we don&#39;t use &quot;formula = &quot; now, and note the comma&#39;s</span></span>
<span id="cb367-5"><a href="lesson-4---answering-research-questions.html#cb367-5" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(brown_ears<span class="sc">$</span>earlength, beige_ears<span class="sc">$</span>earlength,</span>
<span id="cb367-6"><a href="lesson-4---answering-research-questions.html#cb367-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value <span class="sc">%&gt;%</span> <span class="fu">round</span>(.,<span class="dv">3</span>)</span></code></pre></div>
<div id="exercise-4-1" class="section level5 unnumbered question">
<h5>Exercise 4</h5>
<p>Here is some hypothetical data on the tail length of Siameze and Abyssinian cats. We are wondering if siamese cats have <strong>longer tails</strong> than Abyssinian cats. Run the following code to generate the data, and inspect the dataframe we get.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="lesson-4---answering-research-questions.html#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make up some data</span></span>
<span id="cb368-2"><a href="lesson-4---answering-research-questions.html#cb368-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">672022</span>)</span>
<span id="cb368-3"><a href="lesson-4---answering-research-questions.html#cb368-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb368-4"><a href="lesson-4---answering-research-questions.html#cb368-4" aria-hidden="true" tabindex="-1"></a>staartlengtes <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">30</span>, <span class="dv">4</span>)</span>
<span id="cb368-5"><a href="lesson-4---answering-research-questions.html#cb368-5" aria-hidden="true" tabindex="-1"></a>noise <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">2.5</span>)</span>
<span id="cb368-6"><a href="lesson-4---answering-research-questions.html#cb368-6" aria-hidden="true" tabindex="-1"></a>noise2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">8.5</span>)</span>
<span id="cb368-7"><a href="lesson-4---answering-research-questions.html#cb368-7" aria-hidden="true" tabindex="-1"></a>staartlengtes_S <span class="ot">&lt;-</span> staartlengtes <span class="sc">+</span> noise</span>
<span id="cb368-8"><a href="lesson-4---answering-research-questions.html#cb368-8" aria-hidden="true" tabindex="-1"></a>staartlengtes_A <span class="ot">&lt;-</span> staartlengtes<span class="sc">*</span><span class="fl">0.8</span> <span class="sc">+</span> noise2</span>
<span id="cb368-9"><a href="lesson-4---answering-research-questions.html#cb368-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-10"><a href="lesson-4---answering-research-questions.html#cb368-10" aria-hidden="true" tabindex="-1"></a>cat_tails <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">breed =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Siamese&quot;</span>,<span class="st">&quot;Abyssinian&quot;</span>),<span class="at">each=</span>n), </span>
<span id="cb368-11"><a href="lesson-4---answering-research-questions.html#cb368-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">tail_length =</span> <span class="fu">c</span>(staartlengtes_S,staartlengtes_A))</span></code></pre></div>
<ol style="list-style-type: upper-alpha">
<li>Which of the two variables is categorical? Tell R that it is.</li>
<li>Make a bar graph depicting this data.</li>
<li>check the assumptions (normality and if relevant, equality of variances)</li>
<li>perform the t-test. Note that we have a one-sided research question here, note the word “longer”. You can use the argument <code>alternative =</code> within <code>t.test()</code>. Check ?t.test</li>
<li>formulate a conclusion.</li>
</ol>
</div>
<details>
<summary>
Click for answer A
</summary>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="lesson-4---answering-research-questions.html#cb369-1" aria-hidden="true" tabindex="-1"></a>cat_tails<span class="sc">$</span>breed <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cat_tails<span class="sc">$</span>breed)</span></code></pre></div>
</details>
<details>
<summary>
Click for answer B
</summary>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="lesson-4---answering-research-questions.html#cb370-1" aria-hidden="true" tabindex="-1"></a>plot_table <span class="ot">&lt;-</span> cat_tails <span class="sc">%&gt;%</span></span>
<span id="cb370-2"><a href="lesson-4---answering-research-questions.html#cb370-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(breed) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">average =</span> <span class="fu">mean</span>(tail_length, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb370-3"><a href="lesson-4---answering-research-questions.html#cb370-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sd =</span> <span class="fu">sd</span>(tail_length, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) )</span>
<span id="cb370-4"><a href="lesson-4---answering-research-questions.html#cb370-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-5"><a href="lesson-4---answering-research-questions.html#cb370-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot data</span></span>
<span id="cb370-6"><a href="lesson-4---answering-research-questions.html#cb370-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-7"><a href="lesson-4---answering-research-questions.html#cb370-7" aria-hidden="true" tabindex="-1"></a>plot_table <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> average)) <span class="sc">+</span></span>
<span id="cb370-8"><a href="lesson-4---answering-research-questions.html#cb370-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">fill=</span><span class="st">&quot;steelblue&quot;</span>)<span class="sc">+</span></span>
<span id="cb370-9"><a href="lesson-4---answering-research-questions.html#cb370-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(<span class="at">x=</span>breed, <span class="at">ymin=</span>average<span class="sc">-</span>sd, <span class="at">ymax=</span>average<span class="sc">+</span>sd), <span class="at">width=</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb370-10"><a href="lesson-4---answering-research-questions.html#cb370-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co"># not necessary, I just like the white background</span></span>
<span id="cb370-11"><a href="lesson-4---answering-research-questions.html#cb370-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Tail length of Abyssinian and Siamese cats&quot;</span>,</span>
<span id="cb370-12"><a href="lesson-4---answering-research-questions.html#cb370-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;errorbars depict 1 standard deviation&quot;</span>,</span>
<span id="cb370-13"><a href="lesson-4---answering-research-questions.html#cb370-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;cat breed&quot;</span>,</span>
<span id="cb370-14"><a href="lesson-4---answering-research-questions.html#cb370-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;average tail length (cm)&quot;</span>) </span></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: stat</code></pre>
<img src="les4_files/figure-html/unnamed-chunk-30-1.png" width="672" />
</details>
<details>
<summary>
Click for answer C
</summary>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="lesson-4---answering-research-questions.html#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normality</span></span>
<span id="cb372-2"><a href="lesson-4---answering-research-questions.html#cb372-2" aria-hidden="true" tabindex="-1"></a>s_df <span class="ot">&lt;-</span> cat_tails[cat_tails<span class="sc">$</span>breed<span class="sc">==</span><span class="st">&quot;Siamese&quot;</span>,]</span>
<span id="cb372-3"><a href="lesson-4---answering-research-questions.html#cb372-3" aria-hidden="true" tabindex="-1"></a>a_df <span class="ot">&lt;-</span> cat_tails[cat_tails<span class="sc">$</span>breed<span class="sc">==</span><span class="st">&quot;Abyssinian&quot;</span>,]</span>
<span id="cb372-4"><a href="lesson-4---answering-research-questions.html#cb372-4" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(s_df<span class="sc">$</span>tail_length)<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.6034619</code></pre>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="lesson-4---answering-research-questions.html#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(a_df<span class="sc">$</span>tail_length)<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.4663104</code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="lesson-4---answering-research-questions.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="co"># equality of variances</span></span>
<span id="cb376-2"><a href="lesson-4---answering-research-questions.html#cb376-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb376-3"><a href="lesson-4---answering-research-questions.html#cb376-3" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(cat_tails<span class="sc">$</span>tail_length, cat_tails<span class="sc">$</span>breed, <span class="at">center =</span> mean)</span></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = mean)
##       Df F value  Pr(&gt;F)  
## group  1   5.959 0.01941 *
##       38                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
Both data columns are normally distributed, but the variances are not equal!
</details>
<details>
<summary>
Click for answer D
</summary>
<ul>
<li>note <code>var.equal = FALSE</code> because of the unequal variances</li>
<li>note <code>alternative = "greater"</code> because of the one-sided question</li>
<li>If you use the formula-statement in t.test, check the order of the factors with <code>levels(cat_tails$breed)</code>! (or type <code>cat_tails$breed</code> and look at the bottom at the factors. )</li>
</ul>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="lesson-4---answering-research-questions.html#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="co"># siamese (first) &quot;greater than&quot; Abyssinian (second)?</span></span>
<span id="cb378-2"><a href="lesson-4---answering-research-questions.html#cb378-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(s_df<span class="sc">$</span>tail_length, a_df<span class="sc">$</span>tail_length, <span class="at">var.equal =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb378-3"><a href="lesson-4---answering-research-questions.html#cb378-3" aria-hidden="true" tabindex="-1"></a><span class="co">#or: (less, because of the order of the factors in breed: Abyssinian is first)</span></span>
<span id="cb378-4"><a href="lesson-4---answering-research-questions.html#cb378-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">formula=</span>cat_tails<span class="sc">$</span>tail_length<span class="sc">~</span>cat_tails<span class="sc">$</span>breed, <span class="at">var.equal =</span> <span class="cn">FALSE</span>, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
</details>
<details>
<summary>
Click for answer E
</summary>
As p&lt;0.05, we can conclude that Siamese cats (mean± sd = 34±3cm) have significant longer tails than Abyssinian cats (mean±sd=25±7cm).
</details>
</div>
</div>
<div id="paired-two-sample-t-test" class="section level3">
<h3>Paired two sample t test</h3>
<p>To investigate a difference question on paired data, we will make use of the dataset <strong>hematocrit_paired</strong> present in server folder <strong>data/lesson4</strong>. This dataset contains the hematocrit values (in %) of a group of athletes before and after altitude workout. Notice that each element (person) of the group is measured twice (before and after) and therefore this is a paired experimental setup.</p>
<p>We want to know whether there is a difference in hematocrit values before vs. after the altitude workout.</p>
<div id="load-the-data" class="section level4">
<h4>1. Load the data</h4>
<p>We will load the data from a datafile on the server:</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="lesson-4---answering-research-questions.html#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check which separator is used between the columns</span></span>
<span id="cb379-2"><a href="lesson-4---answering-research-questions.html#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="co">#We will use read_csv2() to import data file hematocrit_paired into R</span></span>
<span id="cb379-3"><a href="lesson-4---answering-research-questions.html#cb379-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-4"><a href="lesson-4---answering-research-questions.html#cb379-4" aria-hidden="true" tabindex="-1"></a>hematocrit_paired <span class="ot">&lt;-</span><span class="fu">read_csv2</span>( <span class="st">&quot;data/lesson4/hematocrit_paired&quot;</span> )</span></code></pre></div>
<pre><code>## ℹ Using &quot;&#39;,&#39;&quot; as decimal and &quot;&#39;.&#39;&quot; as grouping mark. Use `read_delim()` for more control.</code></pre>
<pre><code>## Rows: 20 Columns: 2
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;;&quot;
## dbl (2): voor, na
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="lesson-4---answering-research-questions.html#cb382-1" aria-hidden="true" tabindex="-1"></a>hematocrit_tidy <span class="ot">&lt;-</span>  <span class="fu">pivot_longer</span>(<span class="at">data =</span> hematocrit_paired, <span class="at">cols =</span> <span class="fu">c</span>(voor, na),  </span>
<span id="cb382-2"><a href="lesson-4---answering-research-questions.html#cb382-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">names_to =</span> <span class="st">&quot;condition&quot;</span>,  <span class="at">values_to =</span> <span class="st">&quot;hematocrit&quot;</span>)</span></code></pre></div>
</div>
<div id="plot-the-data-1" class="section level4">
<h4>2. Plot the data</h4>
<p>We can make a bar graph:</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="lesson-4---answering-research-questions.html#cb383-1" aria-hidden="true" tabindex="-1"></a>hematocrit_tidy_summary <span class="ot">&lt;-</span> hematocrit_tidy <span class="sc">%&gt;%</span></span>
<span id="cb383-2"><a href="lesson-4---answering-research-questions.html#cb383-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span></span>
<span id="cb383-3"><a href="lesson-4---answering-research-questions.html#cb383-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean=</span><span class="fu">mean</span>(hematocrit), <span class="at">stdev=</span><span class="fu">sd</span>(hematocrit))</span>
<span id="cb383-4"><a href="lesson-4---answering-research-questions.html#cb383-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-5"><a href="lesson-4---answering-research-questions.html#cb383-5" aria-hidden="true" tabindex="-1"></a>hematocrit_tidy_summary <span class="sc">%&gt;%</span></span>
<span id="cb383-6"><a href="lesson-4---answering-research-questions.html#cb383-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>condition,<span class="at">y=</span>mean)) <span class="sc">+</span></span>
<span id="cb383-7"><a href="lesson-4---answering-research-questions.html#cb383-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb383-8"><a href="lesson-4---answering-research-questions.html#cb383-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>mean<span class="sc">-</span>stdev, <span class="at">ymax=</span>mean<span class="sc">+</span>stdev), <span class="at">width=</span>.<span class="dv">2</span>)<span class="sc">+</span> <span class="co"># the error bars</span></span>
<span id="cb383-9"><a href="lesson-4---answering-research-questions.html#cb383-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb383-10"><a href="lesson-4---answering-research-questions.html#cb383-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Hematocrit before and after altitude workout &quot;</span>,</span>
<span id="cb383-11"><a href="lesson-4---answering-research-questions.html#cb383-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;errorbars depict 1 standard deviation&quot;</span>,</span>
<span id="cb383-12"><a href="lesson-4---answering-research-questions.html#cb383-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;workout condition&quot;</span>,</span>
<span id="cb383-13"><a href="lesson-4---answering-research-questions.html#cb383-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;average hematocrit (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb383-14"><a href="lesson-4---answering-research-questions.html#cb383-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="co"># legend is not needed</span></span></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: stat</code></pre>
<p><img src="les4_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<!-- Kan heel geod dat er best verschillen zijn maar dat je die in een bar graph door paired design niet ziet. Voor nu laat ik het zo. -->
</div>
<div id="check-normality-1" class="section level4">
<h4>3. Check normality</h4>
<p>First we have to check the assumption for doing a t-test: normally distributed residuals. However, which residuals should we be looking at here?</p>
<p>In a paired experimental setup, data in the two conditions that are to be compared are not independent. Rather, they appear in pairs. In the hematocrit-dataset, data in each row (2 datapoints) belongs to the same participant. Some athletes in the experiment may just have a higher hematocrit than others, but this is not what we are interested in. We are interested in the difference between before and after the workout, regardless of individual baseline differences between athletes.</p>
<p>If we would just do a normal unpaired t-test, effects of the workout (within subject effects) would be a lot harder to see because of all the individual differences (between subject effects) in which we are not interested. In a normal unpaired t-test, these sources of variance would be mixed. Luckily, we can get rid of the between subject variance by looking at the difference in hematocrit between the two measurements for each athlete and test if these differences are significantly different from 0. This is exactly what a paired-sample t-test does.</p>
<p>Now, as a paired sample t-test is in fact a one-sample t test on the difference between conditions (before and after in this case), the normality assumption also considers these difference scores:</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="lesson-4---answering-research-questions.html#cb385-1" aria-hidden="true" tabindex="-1"></a>hematocrit_difference <span class="ot">&lt;-</span> hematocrit_paired<span class="sc">$</span>na <span class="sc">-</span> hematocrit_paired<span class="sc">$</span>voor</span>
<span id="cb385-2"><a href="lesson-4---answering-research-questions.html#cb385-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-3"><a href="lesson-4---answering-research-questions.html#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(hematocrit_difference)<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.2921799</code></pre>
<p>p-value &gt; 0,05. Accept H0: The differences are normally distributed.</p>
</div>
<div id="perform-the-t-test-1" class="section level4">
<h4>4. Perform the t-test</h4>
<p>We can now perform a paired t-test. Before we can conduct the t-test we have to formulate the H0 and H1:</p>
<p><strong>H0: μ1 = μ2</strong> (hematocrit values before and after workout <strong>do not differ</strong>)</p>
<p><strong>H1: μ1 ≠ μ2</strong> (hematocrit values before and after workout <strong>do differ</strong>)</p>
<div id="example-50" class="section level6">
<h6>Example</h6>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="lesson-4---answering-research-questions.html#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>( hematocrit_paired<span class="sc">$</span>voor , hematocrit_paired<span class="sc">$</span>na , </span>
<span id="cb387-2"><a href="lesson-4---answering-research-questions.html#cb387-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">paired =</span> <span class="cn">TRUE</span> )<span class="sc">$</span>p.value <span class="sc">%&gt;%</span> </span>
<span id="cb387-3"><a href="lesson-4---answering-research-questions.html#cb387-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>( <span class="at">digits =</span> <span class="dv">3</span> )</span></code></pre></div>
<pre><code>## [1] 0.227</code></pre>
<p>Compare this to the one sample t-test on whether the individual differences between before and after differ from 0. It will be the same:</p>
</div>
<div id="example-51" class="section level6">
<h6>Example</h6>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="lesson-4---answering-research-questions.html#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>( hematocrit_difference, <span class="at">mu=</span><span class="dv">0</span>)<span class="sc">$</span>p.value <span class="sc">%&gt;%</span> </span>
<span id="cb389-2"><a href="lesson-4---answering-research-questions.html#cb389-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>( <span class="at">digits =</span> <span class="dv">3</span> )</span></code></pre></div>
<pre><code>## [1] 0.227</code></pre>
</div>
</div>
<div id="draw-a-conclusion-1" class="section level4">
<h4>5. Draw a conclusion</h4>
<p>The p-value is &gt; 0,05: accepts H0. There is no statistically significant difference in hematocrit levels between the samples before and after altitude workout.</p>
</div>
</div>
<div id="plotting-significance" class="section level3">
<h3>Plotting significance</h3>
<p>We previously tested the difference in ear length between brown and beige rabbits, which was significant:</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="lesson-4---answering-research-questions.html#cb391-1" aria-hidden="true" tabindex="-1"></a>p_to_plot <span class="ot">&lt;-</span> <span class="fu">t.test</span>(earlength <span class="sc">~</span> colour, <span class="at">data=</span>rabbit_ears)<span class="sc">$</span>p.value <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<p>Let’s put an asterix in the plot to communicate the the difference is in fact significant, using the <code>ggsignif</code> package
<em>Install the package first!</em></p>
<p>You can also use <code>annotate()</code> to put text in a ggplot anywhere you like:</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="lesson-4---answering-research-questions.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsignif)</span>
<span id="cb392-2"><a href="lesson-4---answering-research-questions.html#cb392-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-3"><a href="lesson-4---answering-research-questions.html#cb392-3" aria-hidden="true" tabindex="-1"></a>colour_rabbits_summary <span class="sc">%&gt;%</span></span>
<span id="cb392-4"><a href="lesson-4---answering-research-questions.html#cb392-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>colour,<span class="at">y=</span>mean_ear, <span class="at">group=</span>colour, <span class="at">fill=</span>colour)) <span class="sc">+</span> </span>
<span id="cb392-5"><a href="lesson-4---answering-research-questions.html#cb392-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span> </span>
<span id="cb392-6"><a href="lesson-4---answering-research-questions.html#cb392-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>mean_ear<span class="sc">-</span>stdev, <span class="at">ymax=</span>mean_ear<span class="sc">+</span>stdev), <span class="at">width=</span>.<span class="dv">2</span>)<span class="sc">+</span> <span class="co"># the error bars</span></span>
<span id="cb392-7"><a href="lesson-4---answering-research-questions.html#cb392-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Figure X. average ear length of rabbits&quot;</span>, </span>
<span id="cb392-8"><a href="lesson-4---answering-research-questions.html#cb392-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;errorbars depict 1 standard deviation&quot;</span>,</span>
<span id="cb392-9"><a href="lesson-4---answering-research-questions.html#cb392-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;rabbit colour&quot;</span>, </span>
<span id="cb392-10"><a href="lesson-4---answering-research-questions.html#cb392-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;average ear length (cm)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb392-11"><a href="lesson-4---answering-research-questions.html#cb392-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">35</span>) <span class="sc">+</span> </span>
<span id="cb392-12"><a href="lesson-4---answering-research-questions.html#cb392-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_signif</span>(</span>
<span id="cb392-13"><a href="lesson-4---answering-research-questions.html#cb392-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;beige&quot;</span>, <span class="st">&quot;brown&quot;</span>)),</span>
<span id="cb392-14"><a href="lesson-4---answering-research-questions.html#cb392-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_position =</span> <span class="dv">30</span>, <span class="at">tip_length =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="fl">0.2</span>,</span>
<span id="cb392-15"><a href="lesson-4---answering-research-questions.html#cb392-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation =</span> <span class="fu">c</span>(<span class="st">&quot;*&quot;</span>)</span>
<span id="cb392-16"><a href="lesson-4---answering-research-questions.html#cb392-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb392-17"><a href="lesson-4---answering-research-questions.html#cb392-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">35</span>, <span class="at">label =</span> <span class="st">&quot;two sample t-test p=0.002&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: stat</code></pre>
<p><img src="les4_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="anova" class="section level3">
<h3>ANOVA</h3>
<p>If we want to compare whether three (or more) samples are significantly different we make use of an ANOVA test. In one-way ANOVA test, a significant p-value indicates that some of the group means are different, but we don’t know which pairs of groups are different!</p>
<div class="tip">
<p>ANOVA can be used to compare three or more groups/conditions.</p>
</div>
<p>The R function to perform the ANOVA test is <code>aov()</code> in combination with the function <code>summary.aov()</code></p>
<div id="load-data-prepare-data" class="section level4">
<h4>1. Load data, prepare data</h4>
<p>We will use the built-in dataset <strong><em>PlantGrowth</em></strong>. This dataset contains the results from an experiment to compare yields (as measured by dried weight of plants) obtained under a control and two different treatment conditions.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="lesson-4---answering-research-questions.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dataframe contains 2 variables: the group variable contains three groups</span></span>
<span id="cb394-2"><a href="lesson-4---answering-research-questions.html#cb394-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PlantGrowth)</span></code></pre></div>
<pre><code>##   weight group
## 1   4.17  ctrl
## 2   5.58  ctrl
## 3   5.18  ctrl
## 4   6.11  ctrl
## 5   4.50  ctrl
## 6   4.61  ctrl</code></pre>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="lesson-4---answering-research-questions.html#cb396-1" aria-hidden="true" tabindex="-1"></a>plantgrowth_graph <span class="ot">&lt;-</span> PlantGrowth <span class="sc">%&gt;%</span></span>
<span id="cb396-2"><a href="lesson-4---answering-research-questions.html#cb396-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb396-3"><a href="lesson-4---answering-research-questions.html#cb396-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">round</span>(<span class="fu">mean</span>(weight),<span class="dv">2</span>), <span class="at">sd=</span><span class="fu">round</span>(<span class="fu">sd</span>(weight),<span class="dv">2</span>))</span></code></pre></div>
</div>
<div id="plot-using-bargraph" class="section level4">
<h4>2. Plot using bargraph</h4>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="lesson-4---answering-research-questions.html#cb397-1" aria-hidden="true" tabindex="-1"></a>plantgrowth_graph <span class="sc">%&gt;%</span></span>
<span id="cb397-2"><a href="lesson-4---answering-research-questions.html#cb397-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>group, <span class="at">y=</span>mean, <span class="at">group=</span>group, <span class="at">fill=</span>group)) <span class="sc">+</span></span>
<span id="cb397-3"><a href="lesson-4---answering-research-questions.html#cb397-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)<span class="sc">+</span> </span>
<span id="cb397-4"><a href="lesson-4---answering-research-questions.html#cb397-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>mean<span class="sc">-</span>sd, <span class="at">ymax=</span>mean<span class="sc">+</span>sd), <span class="at">width=</span>.<span class="dv">2</span>)<span class="sc">+</span> <span class="co"># the error bars</span></span>
<span id="cb397-5"><a href="lesson-4---answering-research-questions.html#cb397-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Average dried plant weight &quot;</span>, </span>
<span id="cb397-6"><a href="lesson-4---answering-research-questions.html#cb397-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;control and two treatment conditions&quot;</span>,</span>
<span id="cb397-7"><a href="lesson-4---answering-research-questions.html#cb397-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb397-8"><a href="lesson-4---answering-research-questions.html#cb397-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;yield (grams)&quot;</span>) <span class="sc">+</span></span>
<span id="cb397-9"><a href="lesson-4---answering-research-questions.html#cb397-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>)) <span class="co"># legend is not needed</span></span></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: stat</code></pre>
<p><img src="les4_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
</div>
<div id="check-normality-shapio-wilk-of-groups-separately" class="section level4">
<h4>3. Check normality (Shapio-Wilk) of groups separately</h4>
<p>To conduct an ANOVA test data values in each group have to be normally distributed:</p>
<p>The <code>shapiro.wilk()</code> function takes one group at a time. If we add the group variable then the shaprio-wilk test will be performed on the data of the three groups together. We first have to separate the three groups into three different variables.</p>
<div id="example-52" class="section level6">
<h6>Example</h6>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="lesson-4---answering-research-questions.html#cb399-1" aria-hidden="true" tabindex="-1"></a>PlantGrowth_ctrl <span class="ot">&lt;-</span> PlantGrowth <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">&quot;ctrl&quot;</span>)</span>
<span id="cb399-2"><a href="lesson-4---answering-research-questions.html#cb399-2" aria-hidden="true" tabindex="-1"></a>PlantGrowth_trt1 <span class="ot">&lt;-</span> PlantGrowth <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">&quot;trt1&quot;</span>)</span>
<span id="cb399-3"><a href="lesson-4---answering-research-questions.html#cb399-3" aria-hidden="true" tabindex="-1"></a>PlantGrowth_trt2 <span class="ot">&lt;-</span> PlantGrowth <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">&quot;trt2&quot;</span>)</span>
<span id="cb399-4"><a href="lesson-4---answering-research-questions.html#cb399-4" aria-hidden="true" tabindex="-1"></a>PlantGrowth_tibble <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">ctrl =</span> PlantGrowth_ctrl<span class="sc">$</span>weight,</span>
<span id="cb399-5"><a href="lesson-4---answering-research-questions.html#cb399-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">trt1 =</span> PlantGrowth_trt1<span class="sc">$</span>weight,</span>
<span id="cb399-6"><a href="lesson-4---answering-research-questions.html#cb399-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">trt2 =</span> PlantGrowth_trt2<span class="sc">$</span>weight)</span>
<span id="cb399-7"><a href="lesson-4---answering-research-questions.html#cb399-7" aria-hidden="true" tabindex="-1"></a>PlantGrowth_tibble <span class="sc">%&gt;%</span> </span>
<span id="cb399-8"><a href="lesson-4---answering-research-questions.html#cb399-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(shapiro.test) <span class="sc">%&gt;%</span> </span>
<span id="cb399-9"><a href="lesson-4---answering-research-questions.html#cb399-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dbl</span>(<span class="st">&quot;p.value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb399-10"><a href="lesson-4---answering-research-questions.html#cb399-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  ctrl  trt1  trt2 
## 0.747 0.452 0.564</code></pre>
<p>You can see that we have normally distributed data.</p>
</div>
</div>
<div id="perform-anova" class="section level4">
<h4>4. Perform ANOVA</h4>
<p>The <code>aov()</code> function minimally takes the following arguments:</p>
<ol style="list-style-type: decimal">
<li>formula : A formula specifying the model.</li>
<li>data : A data frame in which the variables specified in the formula will be found.</li>
</ol>
<p>The formula defines the group variables and the measurement variables to be test and is written as measurements ~ group. In our case the measurements are stored in the “weight” variable and the group information is stored in the “group” variable in the original dataset PlantGrowth.</p>
<p>Before conducting the ANOVA test we have to define the H0 and the H1 :</p>
<p><strong>H0: μ1 = μ2 = μ3</strong> (mean dried weight of plants in the 3 conditions is equal)</p>
<p><strong>H1: The means are not all equal</strong> (notice that this one is harder to write in mathematical symbols as this test won’t tell us <strong>which</strong> means are unequal!)</p>
<div id="example-53" class="section level6">
<h6>Example</h6>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="lesson-4---answering-research-questions.html#cb401-1" aria-hidden="true" tabindex="-1"></a>plant_weight <span class="ot">&lt;-</span> <span class="fu">aov</span>(weight <span class="sc">~</span> group, PlantGrowth)</span>
<span id="cb401-2"><a href="lesson-4---answering-research-questions.html#cb401-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(plant_weight)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## group        2  3.766  1.8832   4.846 0.0159 *
## Residuals   27 10.492  0.3886                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Pr(&gt;F) is the p-value, you can see that it is &lt;0.05</p>
</div>
</div>
<div id="draw-a-conclusion-2" class="section level4">
<h4>5. Draw a conclusion</h4>
<p>P-value &lt; 0,05. So H0 is rejected and H1 is accepted: there is a significant difference between the groups in weight (although we don’t know exactly between which groups).</p>
</div>
<div id="post-hoc-tests" class="section level4">
<h4>6. Post hoc tests</h4>
<p><strong>If</strong> there is a significant effect of group here, we may want to check which groups differ. We do this by performing multiple two sample t-tests commparing each combination of two conditions. There is a convenience function to compare them all at once:</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="lesson-4---answering-research-questions.html#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(PlantGrowth<span class="sc">$</span>weight, PlantGrowth<span class="sc">$</span>group, <span class="at">p.adj =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  PlantGrowth$weight and PlantGrowth$group 
## 
##      ctrl   trt1  
## trt1 0.1944 -     
## trt2 0.0877 0.0045
## 
## P value adjustment method: none</code></pre>
<p>The numbers are the p-values for the t-test with each combination of groups.</p>
<p>However, as we perform multiple t-tests here, we need to lower the <span class="math inline">\(alpha\)</span> (more on why this is needed in lesson 7.). We will lower it from the general 0.05, to 0.05 / amount_of_t_tests. So 0.05/3 = 0.017.</p>
<p>Only p-values below 0.017 will now indicate a significant difference.</p>
<p>The table shows that the difference between treatment 1 and treatment 2 is significant (p=0.0045) at an <span class="math inline">\(/alpha\)</span> of 0.017.</p>
<div id="exercise-4-2" class="section level5 unnumbered question">
<h5>Exercise 4</h5>
<p>Chemistry students determine the weight percentage of sodium in bags of potatos using an analytical instrument. Four groups of students divide each bag of chips into 4 equal part for a total of 12 bags. Each group measures the weight / weight % of sodium. The results are listed in the datafile <strong>potato</strong> present in server folder <strong>data/lesson4</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p>Make a boxplot of the data</p></li>
<li><p>Write an R code to perform all required statistical test to test the following H0 and H1:</p></li>
</ol>
<p>H0 : There is no difference in sodium weight/weight % between the 4 groups</p>
<p>H1 : There is a difference in sodium weight/weight % between the 4 groups</p>
</div>
<details>
<summary>
Click for the answer
</summary>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="lesson-4---answering-research-questions.html#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(a)</span></span>
<span id="cb405-2"><a href="lesson-4---answering-research-questions.html#cb405-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-3"><a href="lesson-4---answering-research-questions.html#cb405-3" aria-hidden="true" tabindex="-1"></a><span class="do">## first data import</span></span>
<span id="cb405-4"><a href="lesson-4---answering-research-questions.html#cb405-4" aria-hidden="true" tabindex="-1"></a>potato <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;data/lesson4/potato&quot;</span>, <span class="at">delim =</span> <span class="st">&quot;:&quot;</span>, <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">&quot;,&quot;</span>))</span></code></pre></div>
<pre><code>## Rows: 11 Columns: 4
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;:&quot;
## chr (4): group1, group2, group3, group4
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="lesson-4---answering-research-questions.html#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="do">## use map() to parse each column into a number. Convert output list to tibble</span></span>
<span id="cb407-2"><a href="lesson-4---answering-research-questions.html#cb407-2" aria-hidden="true" tabindex="-1"></a>potato <span class="ot">&lt;-</span> potato <span class="sc">%&gt;%</span> <span class="fu">map</span>(parse_number, <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">&quot;,&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span>
<span id="cb407-3"><a href="lesson-4---answering-research-questions.html#cb407-3" aria-hidden="true" tabindex="-1"></a>potato_tidy <span class="ot">&lt;-</span> potato <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(group1, group2, group3, group4), </span>
<span id="cb407-4"><a href="lesson-4---answering-research-questions.html#cb407-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">names_to =</span> <span class="st">&quot;group&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;weight_%&quot;</span>)</span>
<span id="cb407-5"><a href="lesson-4---answering-research-questions.html#cb407-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-6"><a href="lesson-4---answering-research-questions.html#cb407-6" aria-hidden="true" tabindex="-1"></a>potato_tidy <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span><span class="st">`</span><span class="at">weight_%</span><span class="st">`</span>, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb407-7"><a href="lesson-4---answering-research-questions.html#cb407-7" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb407-8"><a href="lesson-4---answering-research-questions.html#cb407-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;sodium in bags of potatos measured by 4 groups of students&quot;</span>,</span>
<span id="cb407-9"><a href="lesson-4---answering-research-questions.html#cb407-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span> <span class="st">&quot;weight / weight % sodium&quot;</span>)<span class="sc">+</span></span>
<span id="cb407-10"><a href="lesson-4---answering-research-questions.html#cb407-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co">#remove the gray background if you think it is ugly </span></span>
<span id="cb407-11"><a href="lesson-4---answering-research-questions.html#cb407-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="co">#legend is redundant, also increase text size</span></span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="lesson-4---answering-research-questions.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(b)</span></span>
<span id="cb408-2"><a href="lesson-4---answering-research-questions.html#cb408-2" aria-hidden="true" tabindex="-1"></a><span class="do">## shapiro-wilk test</span></span>
<span id="cb408-3"><a href="lesson-4---answering-research-questions.html#cb408-3" aria-hidden="true" tabindex="-1"></a>potato <span class="sc">%&gt;%</span> <span class="fu">map</span>(shapiro.test) <span class="sc">%&gt;%</span> <span class="fu">map_dbl</span>(<span class="st">&quot;p.value&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## group1 group2 group3 group4 
##  0.413  0.066  0.979  0.072</code></pre>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="lesson-4---answering-research-questions.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ANOVA: use the tidy object</span></span>
<span id="cb410-2"><a href="lesson-4---answering-research-questions.html#cb410-2" aria-hidden="true" tabindex="-1"></a>potato_tidy_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="st">`</span><span class="at">weight_%</span><span class="st">`</span> <span class="sc">~</span> group, potato_tidy)</span>
<span id="cb410-3"><a href="lesson-4---answering-research-questions.html#cb410-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(potato_tidy_aov)</span></code></pre></div>
<pre><code>##             Df  Sum Sq  Mean Sq F value Pr(&gt;F)
## group        3 0.00027 0.000091   0.023  0.995
## Residuals   40 0.15990 0.003998</code></pre>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="lesson-4---answering-research-questions.html#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="do">## if you only want to show the p-value of the ANOVA</span></span>
<span id="cb412-2"><a href="lesson-4---answering-research-questions.html#cb412-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb412-3"><a href="lesson-4---answering-research-questions.html#cb412-3" aria-hidden="true" tabindex="-1"></a>potato_tidy_aov_pvalue <span class="ot">&lt;-</span> <span class="fu">summary.aov</span>(potato_tidy_aov)</span>
<span id="cb412-4"><a href="lesson-4---answering-research-questions.html#cb412-4" aria-hidden="true" tabindex="-1"></a>potato_tidy_aov_pvalue[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>] <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digit =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.995</code></pre>
<p>p&gt;0.05, so there is no significant difference in sodium weight/weight % between the 4 groups.</p>
</details>
<hr />
</div>
</div>
<div id="one-sample-t-test" class="section level3">
<h3>One sample t-test</h3>
<p>A one sample design is actually just a research question regarding a difference, however instead of commparing two samples to each other, you compare one sample to a number / reference value.</p>
<p>Suppose we test a new method for determining mercury and we test this method on a reference material that we know contains 29% mercury</p>
<div id="load-data-prepare-data-1" class="section level4">
<h4>1. Load data, prepare data</h4>
<p>We measured the material 30 times and obtained the following percentages:</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="lesson-4---answering-research-questions.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">30.6</span>, <span class="dv">30</span>, <span class="fl">30.1</span>, <span class="dv">31</span>, <span class="fl">29.8</span>, <span class="fl">29.1</span>, <span class="fl">31.1</span>, <span class="fl">29.5</span>, <span class="fl">30.5</span>, <span class="fl">29.6</span>, <span class="fl">31.6</span>, </span>
<span id="cb414-2"><a href="lesson-4---answering-research-questions.html#cb414-2" aria-hidden="true" tabindex="-1"></a><span class="dv">30</span>, <span class="fl">29.8</span>, <span class="dv">30</span>, <span class="fl">28.9</span>, <span class="fl">29.3</span>, <span class="fl">28.3</span>, <span class="fl">29.2</span>, <span class="fl">30.2</span>, <span class="dv">30</span>, <span class="fl">31.9</span>, <span class="fl">29.4</span>, <span class="fl">29.6</span>, </span>
<span id="cb414-3"><a href="lesson-4---answering-research-questions.html#cb414-3" aria-hidden="true" tabindex="-1"></a><span class="fl">30.2</span>, <span class="fl">29.5</span>, <span class="fl">29.5</span>, <span class="fl">29.4</span>, <span class="fl">29.2</span>, <span class="dv">30</span>, <span class="dv">30</span>)</span></code></pre></div>
<pre><code>##  [1] 30.6 30.0 30.1 31.0 29.8 29.1 31.1 29.5 30.5 29.6 31.6 30.0 29.8 30.0 28.9
## [16] 29.3 28.3 29.2 30.2 30.0 31.9 29.4 29.6 30.2 29.5 29.5 29.4 29.2 30.0 30.0</code></pre>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="lesson-4---answering-research-questions.html#cb416-1" aria-hidden="true" tabindex="-1"></a>m_data<span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">mercury=</span>mercury)</span></code></pre></div>
<p>Question: Is there a systematic error in our new method? So: is there a significant difference between our measurements and 29%?</p>
</div>
<div id="plot-the-data-2" class="section level4">
<h4>2. Plot the data</h4>
<div id="exercise-4-3" class="section level5 unnumbered question">
<h5>Exercise 4</h5>
<p>Plot the data in a histogram.</p>
</div>
<details>
<summary>
Click for the answer
</summary>
<p>Looking at the graph, there could be a slight overestimation of the mercury content using our new method.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="lesson-4---answering-research-questions.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> m_data, <span class="fu">aes</span>(<span class="at">x =</span> mercury)) <span class="sc">+</span></span>
<span id="cb417-2"><a href="lesson-4---answering-research-questions.html#cb417-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb417-3"><a href="lesson-4---answering-research-questions.html#cb417-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb417-4"><a href="lesson-4---answering-research-questions.html#cb417-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of mercury measurements&quot;</span>, </span>
<span id="cb417-5"><a href="lesson-4---answering-research-questions.html#cb417-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;using the new method&quot;</span>,</span>
<span id="cb417-6"><a href="lesson-4---answering-research-questions.html#cb417-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;% mercury&quot;</span>, </span>
<span id="cb417-7"><a href="lesson-4---answering-research-questions.html#cb417-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;count&quot;</span>)  </span></code></pre></div>
<img src="les4_files/figure-html/unnamed-chunk-49-1.png" width="672" />
</details>
</div>
<div id="check-normality-2" class="section level4">
<h4>3. Check normality</h4>
<div id="exercise-4-4" class="section level5 unnumbered question">
<h5>Exercise 4</h5>
<p>Check if the mercury measurements are normally distributed</p>
</div>
<details>
<summary>
Click for the answer
</summary>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="lesson-4---answering-research-questions.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(m_data<span class="sc">$</span>mercury)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  m_data$mercury
## W = 0.94722, p-value = 0.1423</code></pre>
They are. We can perform normal parametric tests.
</details>
</div>
<div id="perform-one-sample-t-test" class="section level4">
<h4>4. Perform one sample t-test</h4>
<p>To test if the measurements obtained with this new method significantly differ from the known mercury content, you can do a one sample t-test:</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="lesson-4---answering-research-questions.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(m_data<span class="sc">$</span>mercury, <span class="at">mu =</span> <span class="dv">29</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  m_data$mercury
## t = 7.396, df = 29, p-value = 3.779e-08
## alternative hypothesis: true mean is not equal to 29
## 95 percent confidence interval:
##  29.87781 30.54886
## sample estimates:
## mean of x 
##  30.21333</code></pre>
<p>It gives us a p-value far lower than 0.05. So we indeed find a systematic error in our measurements.</p>
</div>
<div id="draw-a-conclusion-3" class="section level4">
<h4>5. Draw a conclusion</h4>
<p>The average of our measurements is 30.2 and p&lt;0.05, so we have a significant overestimation of the mercury content with our new method.</p>
<hr />
</div>
</div>
<div id="detection" class="section level3">
<h3>Detection</h3>
<p>You could of course use the same statistical test to see if there is for instance any mercury in a different material that should contain none at all. Then you just fill in zero for the mu.</p>
<p>Let’s say we used the old, calibrated method and measured 5 times: 0.12, -0.23, 0.20, -0.14, 0.2.</p>
<p>Let’s test this as well, even though it is not a lot of data:</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="lesson-4---answering-research-questions.html#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">c</span>(<span class="fl">0.12</span>, <span class="sc">-</span><span class="fl">0.23</span>, <span class="fl">0.20</span>, <span class="sc">-</span><span class="fl">0.14</span>, <span class="fl">0.2</span>), <span class="at">mu =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  c(0.12, -0.23, 0.2, -0.14, 0.2)
## t = 0.33292, df = 4, p-value = 0.7559
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  -0.2201884  0.2801884
## sample estimates:
## mean of x 
##      0.03</code></pre>
<p>Given these few measurements, we find no convincing evidence to say that there is any mercury in this material, as the p-value is larger than 0.05. We will however look at the possible trouble arising from these statements based on very low sample sizes in lesson 7.</p>
</div>
</div>
<div id="descriptive-questions" class="section level2">
<h2>Descriptive Questions</h2>
<p>Some research questions do not necessarily rely on inductive statistics, but rather you are interested in for instance the spread or the distribution of a dataset. We covered descriptive statistics (mean, standard deviation etc) in the previous lesson, as well as histograms, but will focus a bit more on line graphs and boxplots here.</p>
<div id="line-graphs" class="section level3">
<h3>Line graphs</h3>
<p>A <strong>line graph</strong> is a graph that connects data points with a line to visualise a (local) trend. The x-axis variable is continuous, preferably with similar intervals and most often involves time series but also concentrations, doses or any other increasing unit. For example, measurement of tumor size per week after treatment, number of species per increasing area unit or a calibration line with fixed increasing concentrations on the x-axis.</p>
<div class="tip">
<p>Note: the x-values of a line graph should always be numeric!! (so no groups, factors etc. No qualitative variables, only quantitative.)</p>
<p>Also, values inbetween the measured x-axis values should theoretically be possible. So the variable needs to be continuous.</p>
</div>
<p>To create a line chart, we use the function <code>geom_line()</code>.</p>
<p>We will use a new dataset called ‘gapminder’, which is part of the <strong>dslabs</strong> package. We will create a line graph showing the change in life expectancy from 1960-2016 in the Netherlands.</p>
<div id="example-54" class="section level6">
<h6>Example</h6>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="lesson-4---answering-research-questions.html#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span></code></pre></div>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="lesson-4---answering-research-questions.html#cb425-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb425-2"><a href="lesson-4---answering-research-questions.html#cb425-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Netherlands&quot;</span>) <span class="sc">%&gt;%</span> <span class="do">## select data from the Netherlands</span></span>
<span id="cb425-3"><a href="lesson-4---answering-research-questions.html#cb425-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> life_expectancy)) <span class="sc">+</span></span>
<span id="cb425-4"><a href="lesson-4---answering-research-questions.html#cb425-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p>We add points to the graph by adding an extra <code>geom_point()</code> layer.</p>
</div>
<div id="example-55" class="section level6">
<h6>Example</h6>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="lesson-4---answering-research-questions.html#cb426-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb426-2"><a href="lesson-4---answering-research-questions.html#cb426-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Netherlands&quot;</span>) <span class="sc">%&gt;%</span> <span class="do">## select data from the Netherlands</span></span>
<span id="cb426-3"><a href="lesson-4---answering-research-questions.html#cb426-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> life_expectancy)) <span class="sc">+</span></span>
<span id="cb426-4"><a href="lesson-4---answering-research-questions.html#cb426-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb426-5"><a href="lesson-4---answering-research-questions.html#cb426-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>Next, we compare the average life_expectancy per continent.</p>
</div>
<div id="example-56" class="section level6">
<h6>Example</h6>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="lesson-4---answering-research-questions.html#cb427-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb427-2"><a href="lesson-4---answering-research-questions.html#cb427-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, continent) <span class="sc">%&gt;%</span> <span class="do">## data is grouped for each continent</span></span>
<span id="cb427-3"><a href="lesson-4---answering-research-questions.html#cb427-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">life_exp =</span> <span class="fu">mean</span>(life_expectancy, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb427-4"><a href="lesson-4---answering-research-questions.html#cb427-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> life_exp)) <span class="sc">+</span> </span>
<span id="cb427-5"><a href="lesson-4---answering-research-questions.html#cb427-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour =</span> continent)) <span class="co"># no need to factorise as continent is text, not a number</span></span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<p>An important feature to show in a graph is the standard deviation (stdev) of your measurements. We will illustrate this with a repeated measures example.</p>
<p>Let’s say we measured <span class="math inline">\(Ca^{2+}\)</span> levels in mg/L in the same pond for 5 days after a mining incident. However, as the <span class="math inline">\(Ca^{2+}\)</span> levels also change with rain levels, etc, we measure 6 times a day and calculate a daily average.</p>
<p>You can just copy paste this code to generate some fake data, we will discuss how to do these kind of steps in following lessons.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="lesson-4---answering-research-questions.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate some fake data</span></span>
<span id="cb428-2"><a href="lesson-4---answering-research-questions.html#cb428-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb428-3"><a href="lesson-4---answering-research-questions.html#cb428-3" aria-hidden="true" tabindex="-1"></a>CA_norm_rand <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">6</span>,<span class="dv">600</span>,<span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">20</span>,<span class="dv">50</span>)),<span class="dv">0</span>),</span>
<span id="cb428-4"><a href="lesson-4---answering-research-questions.html#cb428-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">6</span>,<span class="dv">580</span>,<span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">40</span>)),<span class="dv">0</span>),</span>
<span id="cb428-5"><a href="lesson-4---answering-research-questions.html#cb428-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">6</span>,<span class="dv">370</span>,<span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">30</span>)),<span class="dv">0</span>),</span>
<span id="cb428-6"><a href="lesson-4---answering-research-questions.html#cb428-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">6</span>,<span class="dv">300</span>,<span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">50</span>)),<span class="dv">0</span>),</span>
<span id="cb428-7"><a href="lesson-4---answering-research-questions.html#cb428-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">6</span>,<span class="dv">320</span>,<span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">30</span>)),<span class="dv">0</span>)</span>
<span id="cb428-8"><a href="lesson-4---answering-research-questions.html#cb428-8" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb428-9"><a href="lesson-4---answering-research-questions.html#cb428-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-10"><a href="lesson-4---answering-research-questions.html#cb428-10" aria-hidden="true" tabindex="-1"></a>CA_data<span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">day =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">each=</span><span class="dv">6</span>), </span>
<span id="cb428-11"><a href="lesson-4---answering-research-questions.html#cb428-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">measurement =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>),<span class="dv">5</span>),</span>
<span id="cb428-12"><a href="lesson-4---answering-research-questions.html#cb428-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">CA=</span>CA_norm_rand)</span>
<span id="cb428-13"><a href="lesson-4---answering-research-questions.html#cb428-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-14"><a href="lesson-4---answering-research-questions.html#cb428-14" aria-hidden="true" tabindex="-1"></a>CA_perday <span class="ot">&lt;-</span> CA_data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(day) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean_CA =</span> <span class="fu">mean</span>(CA),</span>
<span id="cb428-15"><a href="lesson-4---answering-research-questions.html#cb428-15" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">stdev_CA =</span> <span class="fu">sd</span>(CA))</span></code></pre></div>
<p>Now we will make the graph. Make sure you do understand these lines:</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="lesson-4---answering-research-questions.html#cb429-1" aria-hidden="true" tabindex="-1"></a>CA_perday <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> mean_CA)) <span class="sc">+</span></span>
<span id="cb429-2"><a href="lesson-4---answering-research-questions.html#cb429-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb429-3"><a href="lesson-4---answering-research-questions.html#cb429-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb429-4"><a href="lesson-4---answering-research-questions.html#cb429-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_CA <span class="sc">-</span> stdev_CA, <span class="at">ymax =</span> mean_CA <span class="sc">+</span> stdev_CA), </span>
<span id="cb429-5"><a href="lesson-4---answering-research-questions.html#cb429-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb429-6"><a href="lesson-4---answering-research-questions.html#cb429-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb429-7"><a href="lesson-4---answering-research-questions.html#cb429-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;CA2+ levels in the duck pond&quot;</span>,</span>
<span id="cb429-8"><a href="lesson-4---answering-research-questions.html#cb429-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle=</span> <span class="st">&quot;20-25 november 2021&quot;</span>,</span>
<span id="cb429-9"><a href="lesson-4---answering-research-questions.html#cb429-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span> <span class="st">&quot;days after incident&quot;</span>,</span>
<span id="cb429-10"><a href="lesson-4---answering-research-questions.html#cb429-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span> <span class="st">&quot;average Ca2+ concentration (mg/L)&quot;</span>)<span class="sc">+</span></span>
<span id="cb429-11"><a href="lesson-4---answering-research-questions.html#cb429-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> <span class="co"># text size and overall theme</span></span>
<span id="cb429-12"><a href="lesson-4---answering-research-questions.html#cb429-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>), <span class="co">#font y axis tick labels</span></span>
<span id="cb429-13"><a href="lesson-4---answering-research-questions.html#cb429-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>), <span class="co">#font x axis tick labels</span></span>
<span id="cb429-14"><a href="lesson-4---answering-research-questions.html#cb429-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)) <span class="co">#lower x-axis title a little</span></span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<!-- <div class="question"> -->
<!-- ##### Exercise 4 {-}  -->
<!-- Use dataset 'gapminder' from the **dslabs** package to answer the following question.  -->
<!-- Make a line graph with points showing the population for Rwanda in time. What happened in 1995? -->
<!-- <!-- (b) Make a line graph to compare the average fertility per region. -->
<p>–&gt;
<!-- </div> --></p>
<!-- <details><summary>Click for the answer</summary> -->
<!-- ```{r} -->
<!-- gapminder %>% filter(country =="Rwanda") %>% -->
<!--   ggplot(aes(x=year, y=population)) + -->
<!--   geom_line() + -->
<!--   geom_point() -->
<!-- ``` -->
<!-- <!-- (b) -->
<p>–&gt;
<!-- <!-- ```{r} --> –&gt;
<!-- <!-- gapminder %>% group_by(year, region) %>% --> –&gt;
<!-- <!--   mutate(mean_fertility = mean(fertility, na.rm = TRUE)) %>% --> –&gt;
<!-- <!--   ggplot(aes(x=year, y=mean_fertility, colour=region)) + --> –&gt;
<!-- <!--   geom_line() --> –&gt;
<!-- <!-- ``` --> –&gt;
<!-- </details> --></p>
</div>
<div id="exercise-4-5" class="section level5 unnumbered question">
<h5>Exercise 4</h5>
<p>Below are the measurements of an experiment on hand trembling as a side effect of using a new drug (TBA) at different doses (in nM). Trembling frequency (in Hz) was measured in triplo.</p>
<table>
<thead>
<tr class="header">
<th align="right">conc_nM</th>
<th align="right">meting1</th>
<th align="right">meting2</th>
<th align="right">meting3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">1.1</td>
<td align="right">1.2</td>
<td align="right">0.8</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">3.1</td>
<td align="right">2.9</td>
<td align="right">3.4</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">5.1</td>
<td align="right">5.3</td>
<td align="right">5.0</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">6.1</td>
<td align="right">5.7</td>
<td align="right">6.1</td>
</tr>
<tr class="odd">
<td align="right">150</td>
<td align="right">7.1</td>
<td align="right">7.2</td>
<td align="right">6.8</td>
</tr>
<tr class="even">
<td align="right">200</td>
<td align="right">8.1</td>
<td align="right">8.1</td>
<td align="right">7.7</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>Put the table into R as a tibble.</li>
<li>Make the data tidy.</li>
</ol>
</div>
<details>
<summary>
Click for the answer
</summary>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="lesson-4---answering-research-questions.html#cb430-1" aria-hidden="true" tabindex="-1"></a>trembling <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">conc_nM =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb430-2"><a href="lesson-4---answering-research-questions.html#cb430-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">meting1 =</span> <span class="fu">c</span>(<span class="fl">1.1</span>,<span class="fl">3.1</span>,<span class="fl">5.1</span>,<span class="fl">6.1</span>,<span class="fl">7.1</span>,<span class="fl">8.1</span>),</span>
<span id="cb430-3"><a href="lesson-4---answering-research-questions.html#cb430-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">meting2 =</span> <span class="fu">c</span>(<span class="fl">1.2</span>,<span class="fl">2.9</span>,<span class="fl">5.3</span>,<span class="fl">5.7</span>,<span class="fl">7.2</span>,<span class="fl">8.1</span>),</span>
<span id="cb430-4"><a href="lesson-4---answering-research-questions.html#cb430-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">meting3 =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">3.4</span>,<span class="fl">5.0</span>,<span class="fl">6.1</span>,<span class="fl">6.8</span>,<span class="fl">7.7</span>))</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="lesson-4---answering-research-questions.html#cb431-1" aria-hidden="true" tabindex="-1"></a>trembling_tidy <span class="ot">&lt;-</span> trembling <span class="sc">%&gt;%</span></span>
<span id="cb431-2"><a href="lesson-4---answering-research-questions.html#cb431-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;meting1&quot;</span>, <span class="st">&quot;meting2&quot;</span>, <span class="st">&quot;meting3&quot;</span>),</span>
<span id="cb431-3"><a href="lesson-4---answering-research-questions.html#cb431-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;measurement&quot;</span>,</span>
<span id="cb431-4"><a href="lesson-4---answering-research-questions.html#cb431-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;trembling_Hz&quot;</span>)</span></code></pre></div>
</details>
<div id="exercise-4-6" class="section level5 unnumbered question">
<h5>Exercise 4</h5>
<ol style="list-style-type: lower-alpha">
<li>Calculate the average and standard deviation of the trembling frequency for each concentration. Use the trembling_tidy object of the previous exercise in combination with the R functions <code>group_by()</code> and <code>summarize()</code> from the tidyverse package. We used them in lesson 2 to get the average “mpg” per amount of gears in the car dataset:</li>
</ol>
<div id="example-57" class="section level6">
<h6>example:</h6>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="lesson-4---answering-research-questions.html#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(mtcars) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(gear) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">average =</span> <span class="fu">mean</span>(mpg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##    gear average
##   &lt;dbl&gt;   &lt;dbl&gt;
## 1     3    16.1
## 2     4    24.5
## 3     5    21.4</code></pre>
<p>Use <code>group_by()</code> on the conc_nM variable of object trembling_tidy</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Make a line graph of the average values and standard deviation.</li>
</ol>
</div>
</div>
<details>
<summary>
Click for the answer
</summary>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="lesson-4---answering-research-questions.html#cb434-1" aria-hidden="true" tabindex="-1"></a>trem_line_mean_sd <span class="ot">&lt;-</span> trembling_tidy <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(conc_nM) <span class="sc">%&gt;%</span></span>
<span id="cb434-2"><a href="lesson-4---answering-research-questions.html#cb434-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(trembling_Hz, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb434-3"><a href="lesson-4---answering-research-questions.html#cb434-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">stdev =</span> <span class="fu">sd</span>(trembling_Hz, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="lesson-4---answering-research-questions.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> trem_line_mean_sd, <span class="fu">aes</span>(<span class="at">x =</span> conc_nM, <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb435-2"><a href="lesson-4---answering-research-questions.html#cb435-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb435-3"><a href="lesson-4---answering-research-questions.html#cb435-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb435-4"><a href="lesson-4---answering-research-questions.html#cb435-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> stdev, <span class="at">ymax =</span> mean <span class="sc">+</span> stdev), </span>
<span id="cb435-5"><a href="lesson-4---answering-research-questions.html#cb435-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="dv">5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb435-6"><a href="lesson-4---answering-research-questions.html#cb435-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb435-7"><a href="lesson-4---answering-research-questions.html#cb435-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Hand trembling at different doses of medicine TBA&quot;</span>,</span>
<span id="cb435-8"><a href="lesson-4---answering-research-questions.html#cb435-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;errorbars denote 1 standard deviation&quot;</span>,</span>
<span id="cb435-9"><a href="lesson-4---answering-research-questions.html#cb435-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span> <span class="st">&quot;average TBA concentration (nM)&quot;</span>,</span>
<span id="cb435-10"><a href="lesson-4---answering-research-questions.html#cb435-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span> <span class="st">&quot;Hand trembling (Hz)&quot;</span></span>
<span id="cb435-11"><a href="lesson-4---answering-research-questions.html#cb435-11" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb435-12"><a href="lesson-4---answering-research-questions.html#cb435-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> <span class="co"># text size and overall theme</span></span>
<span id="cb435-13"><a href="lesson-4---answering-research-questions.html#cb435-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>), <span class="co">#font y axis tick labels</span></span>
<span id="cb435-14"><a href="lesson-4---answering-research-questions.html#cb435-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>), <span class="co">#font x axis tick labels</span></span>
<span id="cb435-15"><a href="lesson-4---answering-research-questions.html#cb435-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)) <span class="co">#lower x-axis title a little</span></span></code></pre></div>
<img src="les4_files/figure-html/unnamed-chunk-64-1.png" width="672" />
</details>
</div>
<div id="boxplots" class="section level3">
<h3>Boxplots</h3>
<p>A <strong>boxplot</strong> (box and whisker plot) is a graph that shows the spread of quantitative data based on quartiles and outliers (see figure below). Quartiles are just the datapoints, devided in 4 sections of equal amounts of datapoint. So the upper value of the lowest 25% of datapoints is the 25th percentile. The upper value of the lowest 50% of datapoints is the median. The upper value of the lowest 75% of datapoints is the 75th percentile.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-65"></span>
<img src="images/04_2_boxplot.jpg" alt="Interpretation of a boxplot. IQR = Inter Quartile Range." width="50%" />
<p class="caption">
Figure 8: Interpretation of a boxplot. IQR = Inter Quartile Range.
</p>
</div>
<p>Now R calculates the difference between the 75th percentile and the 25th percentile. This is the Interquartile range (IQR). The upper whisker (vertical stripe) extends from the hinge (the box) to the largest value no further than 1.5 * IQR from the hinge. So 1.5 * IQR above the 75th percentile on top, and 1.5 * IQR below the 25th percentile on the bottom.</p>
<p>To create a boxplot, we can use the function <code>geom_boxplot()</code>. We will use the <code>airquality</code> dataset which is built-in in R and contains daily air quality measurements in New York, May to September 1973. The variable “Ozone” contains mean ozone concentration in parts per billion from 13:00 to 15:00 hours at Roosevelt Island. We will put the data in a tibble:</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="lesson-4---answering-research-questions.html#cb436-1" aria-hidden="true" tabindex="-1"></a>airdf <span class="ot">&lt;-</span> <span class="fu">as.tibble</span>(airquality)</span></code></pre></div>
<pre><code>## Warning: `as.tibble()` was deprecated in tibble 2.0.0.
## Please use `as_tibble()` instead.
## The signature and semantics have changed, see `?as_tibble`.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="lesson-4---answering-research-questions.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(airdf)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##   Ozone Solar.R  Wind  Temp Month   Day
##   &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1    41     190   7.4    67     5     1
## 2    36     118   8      72     5     2
## 3    12     149  12.6    74     5     3
## 4    18     313  11.5    62     5     4
## 5    NA      NA  14.3    56     5     5
## 6    28      NA  14.9    66     5     6</code></pre>
<p>We can see that “Month” is saved as a number. However, suppose we want to group measurements per month and create a box for each month. We have to tell R to treat Month as factor rather than numeric with <code>as.factor()</code>.</p>
<div id="example-58" class="section level6">
<h6>Example</h6>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="lesson-4---answering-research-questions.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> airdf, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(Month), <span class="at">y =</span> Ozone)) <span class="sc">+</span></span>
<span id="cb440-2"><a href="lesson-4---answering-research-questions.html#cb440-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(Month)))</span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
</div>
<div id="exercise-4-7" class="section level5 unnumbered question">
<h5>Exercise 4</h5>
<p>ggplot has been giving us an warning:</p>
<blockquote>
<p>Warning message:
Removed 37 rows containing non-finite values (stat_boxplot).</p>
</blockquote>
<p>Why?</p>
</div>
<details>
<summary>
Click for the answer
</summary>
<p>There are 37 missing values in the “Ozone” column.</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="lesson-4---answering-research-questions.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(airdf<span class="sc">$</span>Ozone))</span></code></pre></div>
<pre><code>## [1] 37</code></pre>
</details>
<p>Box plots can be used to look for outliers. Outliers are datapoints that differ significantly from the distribution of the rest of the data.</p>
<p>In boxplots, any datapoint that is more than 1.5 * IQR above the 75th percentile or 1.5 * IQR below the 25th percentile is considered a potential outlier. They are plotted as individual points.</p>
<p>To change to colour of the potential outliers use <em>outlier.colour</em>. To change to shape of the outliers use <em>outlier.shape</em>.</p>
<div id="example-59" class="section level6">
<h6>Example</h6>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="lesson-4---answering-research-questions.html#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> airdf, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(Month), <span class="at">y =</span> Ozone)) <span class="sc">+</span></span>
<span id="cb443-2"><a href="lesson-4---answering-research-questions.html#cb443-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(Month)), <span class="at">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 37 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="les4_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<p></br></br>
Boxplots are often presented with flipped coordinates. Also, a legend here is not needed:</p>
</div>
<div id="example-60" class="section level6">
<h6>Example</h6>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="lesson-4---answering-research-questions.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> airdf, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(Month), <span class="at">y =</span> Ozone)) <span class="sc">+</span></span>
<span id="cb445-2"><a href="lesson-4---answering-research-questions.html#cb445-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(Month)), </span>
<span id="cb445-3"><a href="lesson-4---answering-research-questions.html#cb445-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">8</span>,<span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb445-4"><a href="lesson-4---answering-research-questions.html#cb445-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 37 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="les4_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<p>Now this isn’t a usable graph. To finish your graph for communication, informative labels are required as well as putting some effort into making it look nice!</p>
</div>
<div id="example-61" class="section level6">
<h6>Example</h6>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="lesson-4---answering-research-questions.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> airdf, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(Month), <span class="at">y =</span> Ozone)) <span class="sc">+</span></span>
<span id="cb447-2"><a href="lesson-4---answering-research-questions.html#cb447-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(Month)), </span>
<span id="cb447-3"><a href="lesson-4---answering-research-questions.html#cb447-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">8</span>,<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb447-4"><a href="lesson-4---answering-research-questions.html#cb447-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb447-5"><a href="lesson-4---answering-research-questions.html#cb447-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;May&quot;</span>,<span class="st">&quot;June&quot;</span>,<span class="st">&quot;July&quot;</span>,<span class="st">&quot;August&quot;</span>,<span class="st">&quot;September&quot;</span>)) <span class="sc">+</span></span>
<span id="cb447-6"><a href="lesson-4---answering-research-questions.html#cb447-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> <span class="co"># text size and overall theme</span></span>
<span id="cb447-7"><a href="lesson-4---answering-research-questions.html#cb447-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>), <span class="co">#font y axis tick labels</span></span>
<span id="cb447-8"><a href="lesson-4---answering-research-questions.html#cb447-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>), <span class="co">#font x axis tick labels</span></span>
<span id="cb447-9"><a href="lesson-4---answering-research-questions.html#cb447-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="dv">2</span>))<span class="sc">+</span> <span class="co">#lower x-axis title a little</span></span>
<span id="cb447-10"><a href="lesson-4---answering-research-questions.html#cb447-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb447-11"><a href="lesson-4---answering-research-questions.html#cb447-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Mean ozone concentration at Roosevelt Island&quot;</span>,</span>
<span id="cb447-12"><a href="lesson-4---answering-research-questions.html#cb447-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle=</span> <span class="st">&quot;per day, measured 1300 to 1500h, May to September 1973&quot;</span>,</span>
<span id="cb447-13"><a href="lesson-4---answering-research-questions.html#cb447-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span> <span class="st">&quot;Month&quot;</span>,</span>
<span id="cb447-14"><a href="lesson-4---answering-research-questions.html#cb447-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span> <span class="st">&quot;average [Ozone] (ppb)&quot;</span></span>
<span id="cb447-15"><a href="lesson-4---answering-research-questions.html#cb447-15" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>## Warning: Removed 37 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="les4_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
</div>
<div id="exercise-4-8" class="section level5 unnumbered question">
<h5>Exercise 4</h5>
<p>Use the built-in dataset ‘iris’ to answer the following question. Make a boxplot showing the summary data of the variable “Sepal.Lenght” for the different iris species listed in the “Species” variable. Each boxplot has a different color.</p>
</div>
<details>
<summary>
Click for the answer
</summary>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="lesson-4---answering-research-questions.html#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Species, <span class="at">y =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb449-2"><a href="lesson-4---answering-research-questions.html#cb449-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Species))<span class="sc">+</span></span>
<span id="cb449-3"><a href="lesson-4---answering-research-questions.html#cb449-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb449-4"><a href="lesson-4---answering-research-questions.html#cb449-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Sepal Lenght of different iris species&quot;</span>,</span>
<span id="cb449-5"><a href="lesson-4---answering-research-questions.html#cb449-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span> <span class="st">&quot;Sepal Length&quot;</span></span>
<span id="cb449-6"><a href="lesson-4---answering-research-questions.html#cb449-6" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb449-7"><a href="lesson-4---answering-research-questions.html#cb449-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>))</span></code></pre></div>
<img src="les4_files/figure-html/unnamed-chunk-72-1.png" width="672" />
</details>
<!-- <div class="question"> -->
<!-- ##### Exercise 4 {-}  -->
<!-- Use the built-in dataset 'mpg' to answer the following question. Make a boxplot showing the summary data of the variable "hwy" for the different cars listed in the "class" variable. Use `?mpg` to find information about this dataset. Color the outliers purple and flip the boxplot 90 degrees. -->
<!-- </div> -->
<!-- <details><summary>Click for the answer</summary> -->
<!-- ```{r} -->
<!-- ggplot(data = mpg, aes(x = class, y = hwy)) + -->
<!--   geom_boxplot(aes(fill = class), outlier.colour = "purple") + -->
<!--   coord_flip()+ -->
<!--   labs( -->
<!--     title = "efficiency of different car types", -->
<!--     subtitle= "car models 1999 - 2008", -->
<!--     x= "class", -->
<!--     y= "efficiency (highway miles per gallon)" -->
<!--     )+ -->
<!--   theme(legend.position = "none", text = element_text(size=16)) -->
<!-- ``` -->
<!-- </details> -->
</div>
</div>
<div id="outliers" class="section level2">
<h2>Outliers</h2>
<!-- Hier zou wel meer aandacht naar mogen maar past nu niet -->
<p>Potential outliers are easy to spot in a boxplot. Outliers can be an underlying reason that a Shapiro-Wilk test is telling you the data are not normally distributed, while you would have expected normally distributed data.</p>
<!-- ### Repeated measures of the same item: -->
<!-- You have met the Dixon's q-test before for repeated measures of the same individual! So for instance when you measure the ear length of the same single rabbit (named Flappie, lives in your garden, brown tail, likes cucumber) 5 times, you can check for outliers using the Dixon's q test. This test only works for repeated measures of the same item and low sample numbers, between 3 and 30 datapoints.  -->
<!-- ```{r} -->
<!-- library(outliers) -->
<!-- example_ears <- c(17.5, 17.4, 18.6, 17.3, 17.4) -->
<!-- dixon.test(example_ears) -->
<!-- ``` -->
<!-- 18.6 is an outlier as p<0.05, and it should be removed from the dataset. As Dixon's q test is only done on very low sample sizes, we can easily do this manually: -->
<!-- ```{r} -->
<!-- example_ears[example_ears==18.6] <- NA -->
<!-- example_ears -->
<!-- ``` -->
<p>When doing data analyis, you will have to decide on what to do with potential outliers. A common strategy is to set boundaries within which you consider data points valid data, and reject datapooints that are outside of your boundaries. Similar to the approach in the box plots. But there are other possibilities: you can for instance keep all your data but use non-parametric statistical tests. And there are a couple of nullhypothesis-tests that investigate whether datapoints are outliers or not.</p>
<p>In this example we will follow the boxplot, and consider any point further than 1.5*IQR from the 25th or 75th percentile an outlier. Let’s say we measured the ears of 22 white rabbits:</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="lesson-4---answering-research-questions.html#cb450-1" aria-hidden="true" tabindex="-1"></a>white_rabbit_ears<span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">ear_length=</span><span class="fu">c</span>(<span class="fl">17.5</span>, <span class="fl">13.0</span>, <span class="fl">18.6</span>, <span class="fl">19.4</span>, <span class="fl">20.9</span>, <span class="fl">18.9</span>, <span class="fl">22.8</span>, <span class="fl">20.3</span>, <span class="fl">62.1</span>, <span class="fl">20.4</span>, <span class="fl">23.0</span>,</span>
<span id="cb450-2"><a href="lesson-4---answering-research-questions.html#cb450-2" aria-hidden="true" tabindex="-1"></a><span class="fl">24.1</span>, <span class="fl">26.1</span>, <span class="fl">25.2</span>, <span class="fl">27.8</span>, <span class="fl">28.5</span>, <span class="fl">76.5</span>, <span class="fl">21.5</span>, <span class="fl">20.2</span>, <span class="fl">18.8</span>))</span>
<span id="cb450-3"><a href="lesson-4---answering-research-questions.html#cb450-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-4"><a href="lesson-4---answering-research-questions.html#cb450-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> white_rabbit_ears, <span class="fu">aes</span>( <span class="at">y =</span> ear_length)) <span class="sc">+</span></span>
<span id="cb450-5"><a href="lesson-4---answering-research-questions.html#cb450-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb450-6"><a href="lesson-4---answering-research-questions.html#cb450-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb450-7"><a href="lesson-4---answering-research-questions.html#cb450-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Ear Lenght of white rabbits&quot;</span>,</span>
<span id="cb450-8"><a href="lesson-4---answering-research-questions.html#cb450-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span> <span class="st">&quot;ear Length (cm)&quot;</span></span>
<span id="cb450-9"><a href="lesson-4---answering-research-questions.html#cb450-9" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb450-10"><a href="lesson-4---answering-research-questions.html#cb450-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>))</span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<p>Now if we want to remove those 2 outliers:</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="lesson-4---answering-research-questions.html#cb451-1" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(white_rabbit_ears<span class="sc">$</span>ear_length, .<span class="dv">25</span>)</span>
<span id="cb451-2"><a href="lesson-4---answering-research-questions.html#cb451-2" aria-hidden="true" tabindex="-1"></a>Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(white_rabbit_ears<span class="sc">$</span>ear_length, .<span class="dv">75</span>)</span>
<span id="cb451-3"><a href="lesson-4---answering-research-questions.html#cb451-3" aria-hidden="true" tabindex="-1"></a>IQR<span class="ot">&lt;-</span> <span class="fu">IQR</span>(white_rabbit_ears<span class="sc">$</span>ear_length)</span>
<span id="cb451-4"><a href="lesson-4---answering-research-questions.html#cb451-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-5"><a href="lesson-4---answering-research-questions.html#cb451-5" aria-hidden="true" tabindex="-1"></a><span class="co"># get threshold values for outliers</span></span>
<span id="cb451-6"><a href="lesson-4---answering-research-questions.html#cb451-6" aria-hidden="true" tabindex="-1"></a>Tlower <span class="ot">=</span> Q1<span class="sc">-</span>(<span class="fl">1.5</span><span class="sc">*</span>IQR) </span>
<span id="cb451-7"><a href="lesson-4---answering-research-questions.html#cb451-7" aria-hidden="true" tabindex="-1"></a>Tupper <span class="ot">=</span> Q3<span class="sc">+</span>(<span class="fl">1.5</span><span class="sc">*</span>IQR) </span>
<span id="cb451-8"><a href="lesson-4---answering-research-questions.html#cb451-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-9"><a href="lesson-4---answering-research-questions.html#cb451-9" aria-hidden="true" tabindex="-1"></a><span class="co"># replace outliers with NA</span></span>
<span id="cb451-10"><a href="lesson-4---answering-research-questions.html#cb451-10" aria-hidden="true" tabindex="-1"></a>white_rabbit_ears<span class="sc">$</span>ear_length[white_rabbit_ears<span class="sc">$</span>ear_length <span class="sc">&lt;</span> Tlower] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb451-11"><a href="lesson-4---answering-research-questions.html#cb451-11" aria-hidden="true" tabindex="-1"></a>white_rabbit_ears<span class="sc">$</span>ear_length[white_rabbit_ears<span class="sc">$</span>ear_length <span class="sc">&gt;</span> Tupper] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p><strong>Important</strong> : always report very precisely how many datapoints you excluded and using what method and thresholds! Also, be conservative in throwing away data. Are you really sure it is an outlier?</p>
<p>In this case we are pretty sure. Those would be some very weid rabbits with ears around 70 cm. This is probably a measurement error or some weird mutant mega rabbits that shouldn’t be part of our sample. We can safely ignore these two data points.</p>
</div>
<div id="relation-questions" class="section level2">
<h2>Relation Questions</h2>
<p>Instead of hunting for differences, sometimes we have questions regarding the relation between two variables. Usually, these cases are either correlational studies or regressions.</p>
<p>They are similar, but not the same.</p>
<p>In a correlation analysis, you investigate the relationship between two variables. A pearson’s correlation coefficient (r) is a number describing the linear relationship between two random variables X and Y.</p>
<p>In a regression analysis, you try to find a model (equation) that describes a relationship between two variables X and Y (with Y being random but not X) using the least squares method. For instance in linear regression, this model would look like Y=aX+b. A model can then be used to predict Y if you have a value for X.</p>
<div id="correlation" class="section level3">
<h3>Correlation</h3>
<p>We will investigate correlation with the penguins dataset. We want to explore the correlation between the flipper length and body mass in penguins. Do larger penguins have larger flippers?</p>
<div id="load-data-prepare-data-2" class="section level4">
<h4>1. load data, prepare data</h4>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="lesson-4---answering-research-questions.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb452-2"><a href="lesson-4---answering-research-questions.html#cb452-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(penguins)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 8
##   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Adelie  Torge…           39.1          18.7              181        3750 male 
## 2 Adelie  Torge…           39.5          17.4              186        3800 fema…
## 3 Adelie  Torge…           40.3          18                195        3250 fema…
## 4 Adelie  Torge…           NA            NA                 NA          NA &lt;NA&gt; 
## 5 Adelie  Torge…           36.7          19.3              193        3450 fema…
## 6 Adelie  Torge…           39.3          20.6              190        3650 male 
## # … with 1 more variable: year &lt;int&gt;</code></pre>
</div>
<div id="plot-using-scatterplot" class="section level4">
<h4>2. plot using scatterplot</h4>
<p>This kind of data should be plotted with a scatter plot.</p>
<p>A <strong>scatter plot</strong> is a graph in which the values of two continous variables are plotted along x-axis and y-axis. The pattern of the resulting points could reveal any correlation present. To create a scatter plot we use the function <code>geom_point()</code>.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="lesson-4---answering-research-questions.html#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> flipper_length_mm)) <span class="sc">+</span></span>
<span id="cb454-2"><a href="lesson-4---answering-research-questions.html#cb454-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb454-3"><a href="lesson-4---answering-research-questions.html#cb454-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Relation between flipper length and body mass&quot;</span>,</span>
<span id="cb454-4"><a href="lesson-4---answering-research-questions.html#cb454-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot; Penguins, Palmer Station LTER&quot;</span>,</span>
<span id="cb454-5"><a href="lesson-4---answering-research-questions.html#cb454-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Flipper length (mm)&quot;</span>,</span>
<span id="cb454-6"><a href="lesson-4---answering-research-questions.html#cb454-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Body mass (g)&quot;</span>) <span class="sc">+</span></span>
<span id="cb454-7"><a href="lesson-4---answering-research-questions.html#cb454-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="les4_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<p>At first glance, it seems that heavier penguins have longer flippers.</p>
<p>The graph shows a increasing relation between flipper length in mm and body mass in gram, as you see the dots generally being higher on the y-axis with lower body weights (more to the right on the x-axis). In other words how heavier the penguin, the larger its flippers.</p>
</div>
<div id="perform-correlation-analysis" class="section level4">
<h4>3. perform correlation analysis</h4>
<p>We can check whether there is indeed a correlation with <code>cor.test()</code>. <code>cor.test()</code> can do several types of correlation analyses, including the most common: Pearson correlation. Pearson’s correlation is a measure of the linear relationship between two continuous random variables.</p>
<p>Pearson correlation does not strictly require the data itself to be normally distributed, in reality it is a bit more complicated, especially with larger datasets. The ins and outs go beyond the scope of this course.</p>
<!-- Meer van toepassing op regressie eigenlijk. Ik heb geen tijd meer. later. -->
<!-- We will check whether the data is approximately normally distributed using a Q-Q plot. This visualises the difference between a set of datapoints and a theoretical distribution, in this case a normal distribution. If the dots are approximately aligned with the line in the Q-Q plot, we can assume a normal distribution. -->
<!-- ```{r} -->
<!-- ggplot(chinstrap, aes(sample = body_mass_g)) +  -->
<!--   stat_qq() +  -->
<!--   stat_qq_line() -->
<!-- ggplot(chinstrap, aes(sample = flipper_length_mm)) +  -->
<!--   stat_qq() +  -->
<!--   stat_qq_line() -->
<!-- ``` -->
<!-- That doesn't look too bad. -->
<!-- ```{r} -->
<!-- model <- lm(body_mass_g ~ flipper_length_mm, data = chinstrap) -->
<!-- plot(model, 4) -->
<!-- ``` -->
<p>A pearson correlation analysis can be done like this:</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="lesson-4---answering-research-questions.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(penguins<span class="sc">$</span>body_mass_g, penguins<span class="sc">$</span>flipper_length_mm, <span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>))</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  penguins$body_mass_g and penguins$flipper_length_mm
## t = 32.722, df = 340, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.843041 0.894599
## sample estimates:
##       cor 
## 0.8712018</code></pre>
<p>It seems that there is indeed a significant correlation between flipper length and body mass because p is smaller than 0.05. The correlation coefficient is 0.8712018.</p>
<p>However, there are several penguin species in this dataset. Let’s colour the points in the scatterplot based on the species:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="lesson-4---answering-research-questions.html#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> flipper_length_mm)) <span class="sc">+</span></span>
<span id="cb458-2"><a href="lesson-4---answering-research-questions.html#cb458-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> species, </span>
<span id="cb458-3"><a href="lesson-4---answering-research-questions.html#cb458-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> species),</span>
<span id="cb458-4"><a href="lesson-4---answering-research-questions.html#cb458-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,<span class="at">alpha =</span> <span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb458-5"><a href="lesson-4---answering-research-questions.html#cb458-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Relation between flipper length and body mass&quot;</span>,</span>
<span id="cb458-6"><a href="lesson-4---answering-research-questions.html#cb458-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot; Penguins, Palmer Station LTER&quot;</span>,</span>
<span id="cb458-7"><a href="lesson-4---answering-research-questions.html#cb458-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Flipper length (mm)&quot;</span>,</span>
<span id="cb458-8"><a href="lesson-4---answering-research-questions.html#cb458-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Body mass (g)&quot;</span>) <span class="sc">+</span></span>
<span id="cb458-9"><a href="lesson-4---answering-research-questions.html#cb458-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="les4_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<p>We can further modify the graph by changing the shape, size and alpha (= transparency) of the points. Let’s also put the correlation coefficient in the graph with <code>annotate()</code>.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="lesson-4---answering-research-questions.html#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="co"># round correlation coefficient to 1 decimal place</span></span>
<span id="cb460-2"><a href="lesson-4---answering-research-questions.html#cb460-2" aria-hidden="true" tabindex="-1"></a>cor_coefficient <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor.test</span>(penguins<span class="sc">$</span>body_mass_g, penguins<span class="sc">$</span>flipper_length_mm, <span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>))<span class="sc">$</span>estimate,<span class="dv">1</span>)</span>
<span id="cb460-3"><a href="lesson-4---answering-research-questions.html#cb460-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-4"><a href="lesson-4---answering-research-questions.html#cb460-4" aria-hidden="true" tabindex="-1"></a><span class="co"># add to plot</span></span>
<span id="cb460-5"><a href="lesson-4---answering-research-questions.html#cb460-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> flipper_length_mm)) <span class="sc">+</span></span>
<span id="cb460-6"><a href="lesson-4---answering-research-questions.html#cb460-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> species, </span>
<span id="cb460-7"><a href="lesson-4---answering-research-questions.html#cb460-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> species),</span>
<span id="cb460-8"><a href="lesson-4---answering-research-questions.html#cb460-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,<span class="at">alpha =</span> <span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb460-9"><a href="lesson-4---answering-research-questions.html#cb460-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Relation between flipper length and body mass&quot;</span>,</span>
<span id="cb460-10"><a href="lesson-4---answering-research-questions.html#cb460-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot; Penguins, Palmer Station LTER&quot;</span>,</span>
<span id="cb460-11"><a href="lesson-4---answering-research-questions.html#cb460-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Flipper length (mm)&quot;</span>,</span>
<span id="cb460-12"><a href="lesson-4---answering-research-questions.html#cb460-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Body mass (g)&quot;</span>) <span class="sc">+</span></span>
<span id="cb460-13"><a href="lesson-4---answering-research-questions.html#cb460-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb460-14"><a href="lesson-4---answering-research-questions.html#cb460-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">3500</span>, <span class="at">y =</span> <span class="dv">230</span>, <span class="at">size=</span><span class="dv">4</span>,</span>
<span id="cb460-15"><a href="lesson-4---answering-research-questions.html#cb460-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;pearson&#39;s r = &quot;</span>, cor_coefficient))</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="les4_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
</div>
<div id="draw-a-conclusion-4" class="section level4">
<h4>4. draw a conclusion</h4>
<p>Because p &lt; 0.05, the analysis show that there is a significant correlation between flipper length and body mass (p&lt;0.001)*, with a correlation coefficient of 0.9. As can be seen in the graph, penguins with a larger body mass tend to have longer flippers.</p>
<ul>
<li>with very low values for p, you report “p&lt;0.01” or “p&lt;0.001” instead of the exact p-value. Anything above 0.001 is just reported exactly. Don’t confuse the reporting of the p-value (e.g. “p=0.032” or “p&lt;0.001”) with the testing of the p-value against an <span class="math inline">\(/alpha\)</span> of 0.05.</li>
</ul>
<!-- leuk: culmen length en culmen depth geeft over all species een meh-correlatie licht negatief, maar per species licht positief. -->
<hr />
<div id="exercise-4-9" class="section level5 unnumbered question">
<h5>Exercise 4</h5>
<p>Use dataset ‘temp_carbon’ from the <strong>dslabs</strong> package to answer the following questions.</p>
<ol style="list-style-type: lower-alpha">
<li>What are the units used for the variables carbon_emissions and temp_anomaly? use <code>?temp_carbon</code> once you loaded the package.</li>
<li>Make a scatter plot of carbon_emissions (x-axis) and temp_anomaly (y-axis). tip: if an axis title gets too long, you can add a line break by using <code>\n</code>. eg: <code>labs(y = "text text \nmoretext")</code></li>
<li>Rewrite the code of (a) to show ocean_anomaly and land anomaly as separate colours in the graph.</li>
</ol>
</div>
<details>
<summary>
Click for the answer
</summary>
<ol style="list-style-type: lower-alpha">
<li>carbon_emissions: millions of metric tons</li>
</ol>
<p>temp_anomaly: degrees Celsius</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="lesson-4---answering-research-questions.html#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb462-2"><a href="lesson-4---answering-research-questions.html#cb462-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> temp_carbon, </span>
<span id="cb462-3"><a href="lesson-4---answering-research-questions.html#cb462-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> carbon_emissions, <span class="at">y =</span> temp_anomaly)) <span class="sc">+</span></span>
<span id="cb462-4"><a href="lesson-4---answering-research-questions.html#cb462-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb462-5"><a href="lesson-4---answering-research-questions.html#cb462-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Annual mean global temperature anomaly versus carbon emissions. &quot;</span>,</span>
<span id="cb462-6"><a href="lesson-4---answering-research-questions.html#cb462-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Annual carbon emissions (* million metric tons)&quot;</span>,</span>
<span id="cb462-7"><a href="lesson-4---answering-research-questions.html#cb462-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot; Global annual mean temperature anomaly in degrees Celsius </span><span class="sc">\n</span><span class="st">relative to the 20th century mean&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 133 rows containing missing values (geom_point).</code></pre>
<p><img src="les4_files/figure-html/unnamed-chunk-80-1.png" width="672" />
</br>
(c)</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="lesson-4---answering-research-questions.html#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> temp_carbon, </span>
<span id="cb464-2"><a href="lesson-4---answering-research-questions.html#cb464-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> carbon_emissions)) <span class="sc">+</span></span>
<span id="cb464-3"><a href="lesson-4---answering-research-questions.html#cb464-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ocean_anomaly), <span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb464-4"><a href="lesson-4---answering-research-questions.html#cb464-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> land_anomaly), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb464-5"><a href="lesson-4---answering-research-questions.html#cb464-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Annual mean temperature anomaly over oceans and on land </span><span class="sc">\n</span><span class="st">versus carbon emissions. &quot;</span>,</span>
<span id="cb464-6"><a href="lesson-4---answering-research-questions.html#cb464-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Annual carbon emissions (* million metric tons)&quot;</span>,</span>
<span id="cb464-7"><a href="lesson-4---answering-research-questions.html#cb464-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;annual mean temperature anomaly in degrees Celsius </span><span class="sc">\n</span><span class="st">relative to the 20th century mean&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 133 rows containing missing values (geom_point).
## Removed 133 rows containing missing values (geom_point).</code></pre>
<img src="les4_files/figure-html/unnamed-chunk-81-1.png" width="672" />
</details>
<div id="exercise-4-10" class="section level5 unnumbered question">
<h5>Exercise 4</h5>
<p>Use dataset ‘temp_carbon’ from the <strong>dslabs</strong> package to answer the following questions.</p>
<ol style="list-style-type: lower-alpha">
<li>Make the dataset temp_carbon tidy.</li>
<li>Use the tidy dataset to re-create the figure of the previous exercise, part (c) (the colours don’t need to be exaclty the same)</li>
</ol>
</div>
<details>
<summary>
Click for the answer
</summary>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="lesson-4---answering-research-questions.html#cb466-1" aria-hidden="true" tabindex="-1"></a>temp_carb_tidy <span class="ot">&lt;-</span> temp_carbon <span class="sc">%&gt;%</span> </span>
<span id="cb466-2"><a href="lesson-4---answering-research-questions.html#cb466-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;land_anomaly&quot;</span>, <span class="st">&quot;ocean_anomaly&quot;</span>),</span>
<span id="cb466-3"><a href="lesson-4---answering-research-questions.html#cb466-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;anomaly&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;temperature&quot;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="lesson-4---answering-research-questions.html#cb467-1" aria-hidden="true" tabindex="-1"></a>temp_carb_tidy <span class="sc">%&gt;%</span></span>
<span id="cb467-2"><a href="lesson-4---answering-research-questions.html#cb467-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carbon_emissions, <span class="at">y =</span> temperature, <span class="at">colour =</span> anomaly)) <span class="sc">+</span></span>
<span id="cb467-3"><a href="lesson-4---answering-research-questions.html#cb467-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb467-4"><a href="lesson-4---answering-research-questions.html#cb467-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Annual mean temperature anomaly over oceans and on land </span><span class="sc">\n</span><span class="st">versus carbon emissions. &quot;</span>,</span>
<span id="cb467-5"><a href="lesson-4---answering-research-questions.html#cb467-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Annual carbon emissions (* million metric tons)&quot;</span>,</span>
<span id="cb467-6"><a href="lesson-4---answering-research-questions.html#cb467-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;annual mean temperature anomaly in degrees Celsius </span><span class="sc">\n</span><span class="st">relative to the 20th century mean&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 266 rows containing missing values (geom_point).</code></pre>
<p><img src="les4_files/figure-html/unnamed-chunk-83-1.png" width="672" />
</br>
Clearly, working with tidy data makes things easier. We don’t need to add the ocean- and land-points separately.</p>
</details>
</div>
</div>
<div id="regression" class="section level3">
<h3>Regression</h3>
<p>Scatter plots are often used in the lab to make a calibration curve (“ijklijn”). We can use R again to make a calibration curve, again with the <code>ggpubr</code> package that you installed earlier.</p>
<p>A calibration curve is an example of a regression analysis.
We try to find an equation (Y=aX+b) that describes a relationship between two variables X and Y.</p>
<p>We make a scatterplot with <code>ggplot()</code>, and add both the determination coefficient (= the squared correlation coefficient (<span class="math inline">\(R^2\)</span>) ) with <code>stat_cor()</code> and the equation (Y = b + a*X, with a=slope and b=intercept) with <code>stat_regline_equation()</code>.</p>
<div id="load-data-prepare-data-3" class="section level4">
<h4>1. load data, prepare data</h4>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="lesson-4---answering-research-questions.html#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb469-2"><a href="lesson-4---answering-research-questions.html#cb469-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb469-3"><a href="lesson-4---answering-research-questions.html#cb469-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb469-4"><a href="lesson-4---answering-research-questions.html#cb469-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb469-5"><a href="lesson-4---answering-research-questions.html#cb469-5" aria-hidden="true" tabindex="-1"></a><span class="co"># generate some fake data</span></span>
<span id="cb469-6"><a href="lesson-4---answering-research-questions.html#cb469-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb469-7"><a href="lesson-4---answering-research-questions.html#cb469-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)) <span class="co"># X is not a random variable</span></span>
<span id="cb469-8"><a href="lesson-4---answering-research-questions.html#cb469-8" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> df<span class="sc">$</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">sd =</span> <span class="fl">0.8</span>)</span></code></pre></div>
</div>
<div id="plot-using-scatterplot-include-trendline" class="section level4">
<h4>2. plot using scatterplot, include trendline</h4>
</div>
<div id="section" class="section level4">
<h4>&amp;</h4>
</div>
<div id="perform-regression-analysis" class="section level4">
<h4>3. perform regression analysis</h4>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="lesson-4---answering-research-questions.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make calibration line</span></span>
<span id="cb470-2"><a href="lesson-4---answering-research-questions.html#cb470-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb470-3"><a href="lesson-4---answering-research-questions.html#cb470-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb470-4"><a href="lesson-4---answering-research-questions.html#cb470-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb470-5"><a href="lesson-4---answering-research-questions.html#cb470-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(<span class="at">label.y =</span> <span class="dv">60</span>, <span class="at">size =</span> <span class="dv">5</span>,<span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb470-6"><a href="lesson-4---answering-research-questions.html#cb470-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..rr.label.., <span class="at">sep =</span> <span class="st">&quot;~`,`~&quot;</span>))) <span class="sc">+</span></span>
<span id="cb470-7"><a href="lesson-4---answering-research-questions.html#cb470-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_regline_equation</span>(<span class="at">label.y =</span> <span class="dv">55</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb470-8"><a href="lesson-4---answering-research-questions.html#cb470-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">18</span>) <span class="sc">+</span> <span class="co"># text size and overall theme</span></span>
<span id="cb470-9"><a href="lesson-4---answering-research-questions.html#cb470-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Calibration line for X&quot;</span>,</span>
<span id="cb470-10"><a href="lesson-4---answering-research-questions.html#cb470-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;X (units)&quot;</span>,</span>
<span id="cb470-11"><a href="lesson-4---answering-research-questions.html#cb470-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Y (units)&quot;</span>)</span></code></pre></div>
<p><img src="les4_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
</div>
<div id="use-model-for-whatever-you-like" class="section level4">
<h4>4. use model for whatever you like</h4>
<div class="question">
<p>Now you could use the model to predict the Y value for a data point with X=5.4. What would it be?</p>
</div>
<details>
<summary>
Click for the answer
</summary>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="lesson-4---answering-research-questions.html#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fl">1.5</span><span class="sc">*</span>(<span class="fl">3.1</span><span class="sc">*</span><span class="fl">5.4</span>),<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 25.1</code></pre>
</details>
<div class="question">
<p>And the X value for a data point with Y=15?</p>
</div>
<details>
<summary>
Click for the answer
</summary>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="lesson-4---answering-research-questions.html#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>((<span class="dv">15</span><span class="fl">-1.5</span>)<span class="sc">/</span><span class="fl">3.1</span>,<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 4.4</code></pre>
</details>
</div>
</div>
</div>
<div id="checklists" class="section level2">
<h2>Checklists</h2>
<p>for statistical tests and visualisations</p>
<div id="verschilvragen" class="section level3">
<h3>verschilvragen</h3>
<div id="one-sample-design" class="section level4">
<h4>one sample design</h4>
<ol style="list-style-type: decimal">
<li>load data, prepare data</li>
<li>plot using histogram or boxplot</li>
<li>check normality (Shapio-Wilk)</li>
<li>perform one sample t-test</li>
<li>draw a conclusion</li>
</ol>
</div>
<div id="two-sample-design" class="section level4">
<h4>two sample design</h4>
<ol style="list-style-type: decimal">
<li>Look at the experimental design to see if it is paired or unpaired</li>
</ol>
<p>paired:</p>
<ol style="list-style-type: decimal">
<li>load data, prepare data</li>
<li>plot using bargraph or boxplot</li>
<li>check normality (Shapio-Wilk) of difference between conditions</li>
<li>perform two sample t-test</li>
<li>draw a conclusion</li>
</ol>
<p>unpaired:</p>
<ol style="list-style-type: decimal">
<li>load data, prepare data</li>
<li>plot using bargraph or boxplot</li>
<li>check normality (Shapio-Wilk) of both groups separately</li>
<li>check equality of variances (Shapio-Wilk)</li>
<li>perform two sample t-test</li>
<li>draw a conclusion</li>
</ol>
</div>
<div id="anova-2-conditions" class="section level4">
<h4>ANOVA (&gt; 2 conditions)</h4>
<ol style="list-style-type: decimal">
<li>load data, prepare data</li>
<li>plot using bargraph or boxplot</li>
<li>check normality (Shapio-Wilk) of both groups separately</li>
<li>perform ANOVA</li>
<li>if significant, perform post hoc tests</li>
</ol>
</div>
</div>
<div id="verbandvragen" class="section level3">
<h3>verbandvragen</h3>
<p>correlation</p>
<ol style="list-style-type: decimal">
<li>load data, prepare data</li>
<li>plot using scatterplot</li>
<li>perform correlation analysis</li>
<li>draw a conclusion</li>
</ol>
<p>regression</p>
<ol style="list-style-type: decimal">
<li>load data, prepare data</li>
<li>plot using scatterplot, include trendline</li>
<li>perform regression analysis</li>
<li>use model for whatever you like</li>
</ol>
</div>
</div>
<div id="overview-r-functions-1" class="section level2">
<h2>Overview R functions</h2>
<div id="to-create-a-graph" class="section level4">
<h4>To create a graph</h4>
<table>
<thead>
<tr class="header">
<th align="left">function</th>
<th align="left">package</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ggplot()</td>
<td align="left">tidyverse</td>
</tr>
<tr class="even">
<td align="left">geom_bar()</td>
<td align="left">tidyverse</td>
</tr>
<tr class="odd">
<td align="left">geom_col()</td>
<td align="left">tidyverse</td>
</tr>
<tr class="even">
<td align="left">geom_point()</td>
<td align="left">tidyverse</td>
</tr>
<tr class="odd">
<td align="left">geom_smooth</td>
<td align="left">tidyverse</td>
</tr>
<tr class="even">
<td align="left">geom_line()</td>
<td align="left">tidyverse</td>
</tr>
<tr class="odd">
<td align="left">geom_errorbar</td>
<td align="left">tidyverse</td>
</tr>
<tr class="even">
<td align="left">coord_flip()</td>
<td align="left">tidyverse</td>
</tr>
<tr class="odd">
<td align="left">labs()</td>
<td align="left">tidyverse</td>
</tr>
</tbody>
</table>
</div>
<div id="data-transformation" class="section level4">
<h4>Data transformation</h4>
<table>
<thead>
<tr class="header">
<th align="left">function</th>
<th align="left">package</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mutate()</td>
<td align="left">tidyverse</td>
</tr>
<tr class="even">
<td align="left">reorder()</td>
<td align="left">stats</td>
</tr>
<tr class="odd">
<td align="left">filter ()</td>
<td align="left">tidyverse</td>
</tr>
<tr class="even">
<td align="left">group_by()</td>
<td align="left">tidyverse</td>
</tr>
</tbody>
</table>
</div>
<div id="arithmetic" class="section level4">
<h4>Arithmetic</h4>
<table>
<thead>
<tr class="header">
<th align="left">function</th>
<th align="left">package</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">count()</td>
<td align="left">tidyverse</td>
</tr>
<tr class="even">
<td align="left">mean()</td>
<td align="left">base</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lesson-3---importing-data-tidy-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lesson-5---answering-research-questions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
